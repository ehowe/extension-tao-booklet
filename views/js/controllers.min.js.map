{"version":3,"file":"routes.js","sources":["routes.js","Booklet/editBooklet.js","Booklet/preview.js","Booklet/wizard.js","../../taoItems/runner/api/itemRunner.js","../../taoQtiItem/qtiItem/core/qtiClasses.js","../../taoQtiItem/qtiItem/helper/util.js","../../taoQtiItem/qtiItem/helper/rendererConfig.js","../../taoQtiItem/qtiItem/core/Element.js","../../taoQtiItem/qtiItem/core/Loader.js","../../taoQtiItem/qtiItem/helper/interactionHelper.js","../../taoQtiItem/qtiRunner/core/Renderer.js","../../taoQtiPrint/qtiPrintRenderer/renderers/config.js","../../taoQtiPrint/qtiPrintRenderer/renderers/Renderer.js","../../taoQtiPrint/runner/provider/qtiprint.js","../../taoQtiPrint/runner/itemRunner.js","../../taoQtiPrint/lib/qrcode.js","../../taoQtiPrint/runner/testRunner.js","printtest/render.js"],"names":["define","Booklet","actions","editBooklet","wizard","preview","$","_","module","helpers","GenerisTreeSelectClass","section","buildGroupsTree","$container","treeOptions","data","toggleTree","val","toggle","anonymous","$radio","anonymousClass","filter","on","e","target","actionId","_url","saveUrl","saveData","resourceUri","propertyUri","checkedNodes","serverParameters","openNodes","rootNode","saveCallback","current","loadContentBlock","uri","paginate","start","$downloader","hide","append","preventDefault","$form","closest","attr","find","classUri","id","$frame","css","height","is","itemRunnerFactory","providerName","options","isPlainObject","undefined","provider","events","flow","init","done","pending","render","providers","size","Error","isString","length","keys","ItemRunner","container","newData","self","this","initDone","forEach","pendingTask","isFunction","call","trigger","merge","elt","renderDone","HTMLElement","push","get","clear","clearDone","getState","state","setState","getResponses","responses","concat","name","handler","off","isArray","event","register","TypeError","_container","assessmentItem","responseProcessing","_simpleFeedbackRule","stylesheet","math","img","object","outcomeDeclaration","responseDeclaration","rubricBlock","associableHotspot","gap","gapImg","gapText","hotspotChoice","hottext","inlineChoice","simpleAssociableChoice","simpleChoice","associateInteraction","choiceInteraction","endAttemptInteraction","extendedTextInteraction","gapMatchInteraction","graphicAssociateInteraction","graphicGapMatchInteraction","graphicOrderInteraction","hotspotInteraction","hottextInteraction","inlineChoiceInteraction","matchInteraction","mediaInteraction","orderInteraction","prompt","selectPointInteraction","sliderInteraction","textEntryInteraction","uploadInteraction","feedbackBlock","feedbackInline","modalFeedback","customInteraction","infoControl","util","buildSerial","prefix","chars","i","charAt","Math","floor","random","fullpath","src","baseUrl","replace","match","findInCollection","element","collectionNames","searchedSerial","found","each","collectionName","collection","split","nameToken","parent","addMarkupNamespace","markup","ns","removeMarkupNamespaces","getMarkupUsedNamespaces","namespaces","original","slash","node","uniq","rendererConfigHelper","getOptionsFromArguments","args","placeholder","subclass","renderer","arg","isRenderer","console","log","Class","rendererConfig","_instances","Element","extend","qtiClass","serial","relatedItem","attributes","metaData","setAttributes","initContainer","arguments","initObject","getSerial","getUsedIdentifiers","usedIds","elts","getComposingElements","value","prop","document","key","removeData","removeAttr","removeAttributes","getAttributes","clone","attrNames","getBody","getObject","v","isA","getUsedClasses","ret","composingElts","location","item","getRelatedItem","setRelatedItem","recursive","setRenderer","getRenderer","tplData","defaultData","tag","body","getAbsoluteUrl","getData","rendering","renderTpl","replaceWith","postRender","altClassName","getContainer","$scope","toArray","arr","type","isEmpty","addClass","className","clazz","_containClass","hasClass","removeClass","regex","RegExp","isset","issetElement","unset","unsetElement","allClassStr","test","qtiElement","getElementBySerial","composingElements","qtiClasses","loadPortableCustomElementData","portableElement","typeIdentifier","entryPoint","properties","libraries","Loader","classesLocation","qti","setClassesLocation","getRequiredClasses","union","loadRequiredClasses","callback","reload","requiredClasses","required","requiredClass","_this","require","QtiClass","prototype","getLoadedClasses","loadItemData","Qti","loadContainer","outcomes","outcome","buildOutcome","addOutcomeDeclaration","feedbacks","feedback","buildElement","addModalFeedback","stylesheets","addStylesheet","response","buildResponse","addResponseDeclaration","feedbackRules","forIn","fbData","buildSimpleFeedbackRule","setResponseProcessing","buildResponseProcessing","setNamespaces","loadElement","loadElements","allElements","elementData","loadElementData","template","howMatch","defaultValue","correctResponse","correctResponses","mapEntries","mapping","areaMapping","mappingAttributes","feedbackRule","condition","comparedValue","comparedOutcome","feedbackOutcome","feedbackThen","modalFeedbacks","feedbackElse","rp","processingType","xml","bodyObject","bodyData","elements","eltData","setElement","bdy","loadObjectData","loadInteractionData","loadChoiceData","loadMathData","loadPicData","interaction","buildInteractionChoices","loadPciData","choices","set","matchSet","choice","addChoice","gapImgs","addGapImg","text","_alt","setMathML","mathML","annotations","pci","pic","convertChoices","outputType","c","findChoices","inputType","getChoice","getChoiceByIdentifier","shuffleChoices","r","f","j","n","k","tmp","serialToIdentifier","choiceSerial","Handlebars","interactionHelper","getDocumentBaseUrl","window","protocol","host","pathname","_isValidRenderer","valid","classCorrect","indexOf","_renderableClasses","pos","slice","subClass","_renderableSubclasses","_dependencies","Renderer","shuffledChoices","_locations","_renderers","_getClassRenderer","setOption","setOptions","opts","getOption","qtiSubclass","res","decorators","isObject","before","after","renderDirect","tpl","compile","setResponse","qtiInteraction","getResponse","resetResponse","destroy","getLoadedRenderers","renderersLocations","load","intersection","reqClass","deps","requiredSubClasses","values","setShuffledChoices","identificationType","pluck","getShuffledChoices","reshuffle","returnedType","getChoices","index","getRenderers","getLocations","relUrl","absUrl","runtimeLocations","runtimeLocation","build","defaultOptions","NewRenderer","apply","locations","simpleChoice.choiceInteraction","simpleChoice.orderInteraction","simpleAssociableChoice.matchInteraction","simpleAssociableChoice.associateInteraction","config","QtiLoader","QtiRenderer","qtiItemRuntimeProvider","itemData","_renderer","lang","_item","innerHTML","error","itemRunner","qtiRuntimeProvider","QR8bitByte","mode","QRMode","MODE_8BIT_BYTE","parsedData","l","byteArray","code","charCodeAt","Array","unshift","QRCodeModel","typeNumber","errorCorrectLevel","modules","moduleCount","dataCache","dataList","QRPolynomial","num","shift","offset","QRRSBlock","totalCount","dataCount","QRBitBuffer","buffer","_isSupportCanvas","CanvasRenderingContext2D","_getAndroid","android","sAgent","navigator","userAgent","aMat","toString","parseFloat","_getTypeNumber","sText","nCorrectLevel","nType","_getUTF8Length","len","QRCodeLimitLength","nLimit","QRErrorCorrectLevel","L","M","Q","H","replacedText","encodeURI","QRCode","getLength","write","put","addData","isDark","row","col","getModuleCount","make","makeImpl","getBestMaskPattern","maskPattern","setupPositionProbePattern","setupPositionAdjustPattern","setupTimingPattern","setupTypeInfo","setupTypeNumber","createData","mapData","minLostPoint","pattern","lostPoint","QRUtil","getLostPoint","createMovieClip","target_mc","instance_name","depth","qr_mc","createEmptyMovieClip","cs","y","x","dark","beginFill","moveTo","lineTo","endFill","getPatternPosition","bits","getBCHTypeNumber","mod","getBCHTypeInfo","inc","bitIndex","byteIndex","mask","getMask","PAD0","PAD1","rsBlocks","getRSBlocks","getLengthInBits","totalDataCount","putBit","createBytes","maxDcCount","maxEcCount","dcdata","ecdata","dcCount","ecCount","max","rsPoly","getErrorCorrectPolynomial","rawPoly","modPoly","modIndex","totalCodeCount","MODE_NUMBER","MODE_ALPHA_NUM","MODE_KANJI","QRMaskPattern","PATTERN000","PATTERN001","PATTERN010","PATTERN011","PATTERN100","PATTERN101","PATTERN110","PATTERN111","PATTERN_POSITION_TABLE","G15","G18","G15_MASK","d","getBCHDigit","digit","errorCorrectLength","a","multiply","QRMath","gexp","qrCode","sameCount","count","darkCount","ratio","abs","glog","LOG_TABLE","EXP_TABLE","RS_BLOCK_TABLE","rsBlock","getRsBlockTable","list","bufIndex","bit","svgDrawer","Drawing","el","htOption","_el","_htOption","draw","oQRCode","makeSVG","attrs","createElementNS","hasOwnProperty","setAttribute","nCount","width","svg","viewBox","String","fill","colorLight","setAttributeNS","appendChild","colorDark","child","hasChildNodes","removeChild","lastChild","useSVG","documentElement","tagName","toLowerCase","_onMakeImage","_elImage","_elCanvas","toDataURL","style","display","_safeSetDataURI","fSuccess","fFail","_fFail","_fSuccess","_bSupportDataURI","createElement","fOnError","fOnSuccess","onabort","onerror","onload","_android","factor","devicePixelRatio","drawImage","image","sx","sy","sw","sh","dx","dy","dw","nodeName","_bIsPainted","_oContext","getContext","alt","nWidth","nHeight","nRoundedWidth","round","nRoundedHeight","bIsDark","nLeft","nTop","strokeStyle","lineWidth","fillStyle","fillRect","strokeRect","ceil","makeImage","isPainted","clearRect","nNumber","aHTML","join","elTable","childNodes","nLeftMarginTable","offsetWidth","nTopMarginTable","offsetHeight","margin","vOption","correctLevel","getElementById","_oQRCode","_oDrawing","makeCode","title","CorrectLevel","async","testRenderer","createPage","testPage","$testPage","$codeElt","sectionPage","pageNum","$sectionPage","itemPage","$itemContainer","err","testRunnerFactory","testData","items","testRunner","pageRenderers","bind","partial","testParts","testPart","sections","href","parallel","$results","rtl","empty","ready","status","showMessage","msg","printLayoutHacking","previous","threshold","pages","blankPage","$section","computePageFromHeight","children","outerHeight","nextUntil","renderController","setTimeout","$mainContainer"],"mappings":"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GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,GAAA,EAAA,IAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,KAAA,EAAA,IAAA,GAAA,EAAA,IAAA,KAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,GAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,EAAA,IAAA,IAAA,GAAA,IAAA,MAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,IAAA,EAAA,IAAA,MAAA,EAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,EAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,MAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,IAAA,IAAA,EAAA,IAAA,MAAA,GAAA,GAAA,GAAA,GAAA,GAAA,KAAA,GAAA,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","sourcesContent":["/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n *\n */\n\n//@see http://forge.taotesting.com/projects/tao/wiki/Front_js\ndefine('taoBooklet/controller/routes',[],function () {\n    'use strict';\n\n    return {\n        'Booklet': {\n            'actions': {\n                'editBooklet' : 'controller/Booklet/editBooklet',\n                'wizard'      : 'controller/Booklet/wizard',\n                'preview'     : 'controller/Booklet/preview'\n            }\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n */\ndefine('taoBooklet/controller/Booklet/editBooklet',['jquery', 'lodash', 'module', 'helpers', 'generis.tree.select', 'layout/section'], function ($, _, module, helpers, GenerisTreeSelectClass, section) {\n    'use strict';\n\n    /**\n     * Builds group tree inside target container\n     * @param {jQueryElement} $container\n     */\n    function buildGroupsTree($container) {\n\n        var treeOptions = $container.data();\n\n        var toggleTree = function(val) {\n            $container.toggle(val !== treeOptions.anonymous);\n        };\n\n        var $radio = $('[name=\"' + treeOptions.anonymousClass + '\"]');\n\n        toggleTree($radio.filter(':checked').val());\n\n        $radio.on('change', function (e) {\n            toggleTree($(e.target).val());\n        });\n\n        new GenerisTreeSelectClass('#' + treeOptions.actionId + '-tree', helpers._url('getData', 'GenerisTree', 'tao'), {\n            actionId: treeOptions.actionId,\n            saveUrl: treeOptions.saveUrl,\n            saveData: {\n                resourceUri: treeOptions.resourceUri,\n                propertyUri: treeOptions.propertyUri\n            },\n            checkedNodes: treeOptions.checkedNodes,\n            serverParameters: {\n                openNodes: treeOptions.openNodes,\n                rootNode: treeOptions.rootNode\n            },\n            saveCallback: function () {\n                section\n                    .current()\n                    .loadContentBlock(\n                    helpers._url('editBooklet', 'Booklet', 'taoBooklet'),\n                    {uri: treeOptions.resourceUri}\n                );\n            },\n            paginate: 10\n        });\n    }\n\n    return {\n        start: function () {\n\n            var $downloader = $('<iframe/>').hide();\n            $('form').append($downloader);\n\n            $('.btn-download').on('click', function (e) {\n                e.preventDefault();\n                var $form = $(e.target).closest('form');\n\n                $downloader.attr('src', helpers._url('download', 'Booklet', 'taoBooklet', {\n                    uri: $form.find('input[name=\"uri\"]').val(),\n                    classUri: $form.find('input[name=\"classUri\"]').val(),\n                    id: $form.find('input[name=\"id\"]').val()\n                }));\n            });\n\n            buildGroupsTree($('.group-container'));\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n *\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoBooklet/controller/Booklet/preview',['jquery'], function ($) {\n    'use strict';\n\n    return {\n        start: function () {\n\n            //resize the frame to it's container height\n            var $frame = $('.preview-test');\n            var $container  = $frame.closest('.content-container');\n            $frame.css('min-height', ($container.height() - 50) + 'px' );\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n *\n */\ndefine('taoBooklet/controller/Booklet/wizard',['jquery'], function ($) {\n    'use strict';\n\n    return {\n        start: function () {\n\n            var $form = $('.main-container ').find('form');\n\n            var $radio = $('[name=\"' + $form.find('#anonymousClass').val() + '\"]');\n            if (!$radio.is(':checked')) {\n                $radio.filter(':first').attr('checked', true);\n            }\n\n        }\n    };\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\n *\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoItems/runner/api/itemRunner',['jquery', 'lodash'], function($, _){\n    'use strict';\n\n     /**\n     *\n     * Builds a brand new {@link ItemRunner}.\n     *\n     * <strong>The factory is an internal mechanism to create encapsulated contexts.\n     *  I suggest you to use directly the name <i>itemRunner</i> when you require this module.</strong>\n     *\n     * @example require(['itemRunner'], function(itemRunner){\n                    itemRunner({itemId : 12})\n     *                    .on('statechange', function(state){\n     *\n     *                    })\n     *                    .on('ready', function(){\n     *\n     *                    })\n     *                    .on('response', function(){\n     *\n     *                    })\n     *                   .init()\n     *                   .render($('.item-container'));\n     *          });\n     *\n     * @exports itemRunner\n     * @namespace itemRunnerFactory\n     *\n     * @param {String} [providerName] - the name of a provider previously registered see {@link itemRunnerFactory#register}\n     * @param {Object} [data] - the data of the item to run\n     *\n     * @returns {ItemRunner}\n     */\n    var itemRunnerFactory = function itemRunnerFactory(providerName, data, options){\n\n        //optional params based on type\n        if(_.isPlainObject(providerName)){\n            data = providerName;\n            providerName = undefined;\n        }\n        data = data || {};\n\n        //contains the bound events.\n        var events = {};\n\n        //flow structure to manage sync calls in an async context.\n        var flow = {\n            init : {\n                done: false,\n                pending : []\n            },\n            render : {\n                done: false,\n                pending : []\n            }\n        };\n\n        /*\n         * Select the provider\n         */\n\n        var provider;\n        var providers = itemRunnerFactory.providers;\n\n        //check a provider is available\n        if(!providers || _.size(providers) === 0){\n            throw new Error('No provider regitered');\n        }\n\n        if(_.isString(providerName) && providerName.length > 0){\n            provider = providers[providerName];\n        } else if(_.size(providers) === 1) {\n\n            //if there is only one provider, then we take this one\n            providerName = _.keys(providers)[0];\n            provider = providers[providerName];\n        }\n\n        //now we should have a provider\n        if(!provider){\n            throw new Error('No candidate found for the provider');\n        }\n\n\n       /**\n        * The ItemRunner\n        * @typedef {Object} ItemRunner\n        */\n\n        /**\n        * @type {ItemRunner}\n        * @lends itemRunnerFactory\n        */\n        var ItemRunner = {\n\n            /**\n             * Items container\n             * @type {HTMLElement}\n             */\n            container : null,\n\n            options   : options || {},\n\n            /**\n             * Initialize the runner.\n             * @param {Object} [newData] - just in case you want to change item data (it should not occurs in most case)\n             * @returns {ItemRunner} to chain calls\n             *\n             * @fires ItemRunner#init\n             */\n            init : function(newData){\n                var self = this;\n\n                /**\n                 * Call back when init is done\n                 */\n                var initDone = function initDone(){\n\n                   //manage pending tasks the first time\n                    if(flow.init.done === false){\n                        flow.init.done = true;\n\n                        _.forEach(flow.init.pending, function(pendingTask){\n                            if(_.isFunction(pendingTask)){\n                                pendingTask.call(self);\n                            }\n                        });\n                        flow.init.pending = [];\n                    }\n\n                    /**\n                     * the runner has initialized correclty the item\n                     * @event ItemRunner#init\n                     */\n                    self.trigger('init');\n                };\n\n                //merge data\n                if(newData){\n                    data = _.merge(data, newData);\n                }\n\n                if(_.isFunction(provider.init)){\n\n                    /**\n                     * Calls provider's initialization with item data.\n                     * @callback InitItemProvider\n                     * @param {Object} data - the item data\n                     * @param {Function} done - call once the initialization is done\n                     */\n                    provider.init.call(this, data, initDone);\n\n                } else {\n                    initDone();\n                }\n\n                return this;\n            },\n\n            /**\n             * Initialize the current item.\n             *\n             * @param {HTMLElement|jQueryElement} elt - the DOM element that is going to contain the rendered item.\n             * @returns {ItemRunner} to chain calls\n             *\n             * @fires ItemRunner#ready\n             * @fires ItemRunner#render\n             * @fires ItemRunner#error if the elt isn't valid\n             *\n             * @fires ItemRunner#statechange the provider is reponsible to trigger this event\n             * @fires ItemRunner#responsechange  the provider is reponsible to trigger this event\n             */\n           render : function(elt){\n                var self = this;\n\n                /**\n                 * Call back when render is done\n                 */\n                var renderDone = function renderDone (){\n\n                    //manage pending tasks the first time\n                    if(flow.render.done === false){\n                        flow.render.done = true;\n\n                        _.forEach(flow.render.pending, function(pendingTask){\n                            if(_.isFunction(pendingTask)){\n                                pendingTask.call(self);\n                            }\n                        });\n                        flow.render.pending = [];\n                    }\n\n                    /**\n                     * The item is rendered\n                     * @event ItemRunner#render\n                     */\n                    self.trigger('render');\n\n                    /**\n                     * The item is ready.\n                     * Alias of {@link ItemRunner#render}\n                     * @event ItemRunner#ready\n                     */\n                    self.trigger('ready');\n                };\n\n                //check elt\n                if( !(elt instanceof HTMLElement) && !(elt instanceof $) ){\n                    return self.trigger('error', 'A valid HTMLElement (or a jquery element) at least is required to render the item');\n                }\n\n                if(flow.init.done === false){\n                    flow.init.pending.push(function(){\n                        this.render(elt);\n                    });\n                } else {\n\n                    //we keep a reference to the container\n                    if(elt instanceof $){\n                        this.container = elt.get(0);\n                    } else {\n                        this.container = elt;\n                    }\n\n                    //the state will be applied only when the rendering is made\n\n                    if(_.isFunction(provider.render)){\n\n                        /**\n                         * Calls the provider's render\n                         * @callback RendertItemProvider\n                         * @param {HTMLElement} elt - the element to render inside\n                         * @param {Function} done - call once the render is done\n                         */\n                        provider.render.call(this, this.container, renderDone);\n\n                    } else {\n                        renderDone();\n                    }\n                }\n\n                return this;\n           },\n\n           /**\n            * Clear the running item.\n            * @returns {ItemRunner}\n            *\n            * @fires ItemRunner#clear\n            */\n           clear : function(){\n                var self = this;\n\n                /**\n                 * Call back when clear is done\n                 */\n                var clearDone = function clearDone (){\n\n                    //events = {};\n\n                    /**\n                     * The item is ready.\n                     * @event ItemRunner#clear\n                     */\n                    self.trigger('clear');\n                };\n                if(_.isFunction(provider.clear)){\n\n                    /**\n                     * Calls the provider's clear\n                     * @callback ClearItemProvider\n                     * @param {HTMLElement} elt - item's container\n                     * @param {Function} done - call once the initialization is done\n                     */\n                    provider.clear.call(this, this.container, clearDone);\n\n                } else {\n                    clearDone();\n                }\n\n                return this;\n           },\n\n           /**\n            * Get the current state of the running item.\n            *\n            * @returns {Object|Null} state\n            */\n           getState : function(){\n                var state = null;\n                if(_.isFunction(provider.getState)){\n\n                    /**\n                     * Calls the provider's getState\n                     * @callback GetStateItemProvider\n                     * @returns {Object} the state\n                     */\n                    state = provider.getState.call(this);\n                }\n                return state;\n           },\n\n           /**\n            * Set the current state of the running item.\n            * This should have the effect to restore the item state.\n            *\n            * @param {Object} state - the new state\n            * @returns {ItemRunner}\n            *\n            * @fires ItemRunner#error if the state type doesn't match\n            */\n           setState : function(state){\n\n                if(!_.isPlainObject(state)){\n                    return this.trigger('error', \"The item's state must be a JavaScript Plain Object: \" + (typeof state) + ' given');\n                }\n\n                //the state will be applied only when the rendering is made\n                if(flow.render.done === false){\n                    flow.render.pending.push(function(){\n                        this.setState(state);\n                    });\n                } else {\n\n                    if(_.isFunction(provider.setState)){\n\n                        /**\n                         * Calls the provider's setState\n                         * @callback SetStateItemProvider\n                         * @param {Object} state -  the state to set\n                         */\n                        provider.setState.call(this, state);\n                    }\n                }\n                return this;\n           },\n\n           /**\n            * Get the responses of the running item.\n            *\n            * @returns {Array} the item's responses\n            */\n           getResponses : function(){\n                var responses = [];\n                if(_.isFunction(provider.getResponses)){\n\n                    /**\n                     * Calls the provider's getResponses\n                     * @callback GetResponsesItemProvider\n                     * @returns {Array} the responses\n                     */\n                    responses = responses.concat(provider.getResponses.call(this));\n                }\n                return responses;\n           },\n\n           /**\n            * Attach an event handler.\n            * Calling `on` with the same eventName multiple times add callbacks: they\n            * will all be executed.\n            *\n            * @example itemRunner()\n            *               .on('statechange', function(state){\n            *                   //state === this.getState()\n            *               });\n            *\n            * @param {String} name - the name of the event to listen\n            * @param {Function} handler - the callback to run once the event is triggered. It's executed with the current itemRunner context (ie. this\n            * @returns {ItemRunner}\n            */\n            on : function(name, handler){\n                if(_.isString(name) && _.isFunction(handler)){\n                    events[name] = events[name] || [];\n                    events[name].push(handler);\n                }\n                return this;\n            },\n\n            /**\n            * Remove handlers for an event.\n            *\n            * @example itemRunner().off('statechange');\n            *\n            * @param {String} name - the event name\n            * @returns {ItemRunner}\n            */\n            off : function(name){\n                if(_.isString(name)){\n                    events[name] = [];\n                }\n                return this;\n            },\n\n            /**\n            * Trigger an event manually.\n            *\n            * @example itemRunner().trigger('statechange', new State());\n            *\n            * @param {String} name - the name of the event to trigger\n            * @param {*} data - arguments given to the handlers\n            * @returns {ItemRunner}\n            */\n            trigger : function(name, data){\n                var self = this;\n                if(_.isString(name) && _.isArray(events[name])){\n                    _.forEach(events[name], function(event){\n                        event.call(self, data);\n                    });\n                }\n                return this;\n            }\n        };\n\n        return ItemRunner;\n    };\n\n    /**\n     * Register an <i>Item Runtime Provider</i> into the item runner.\n     * The provider provides the behavior required by the item runner.\n     *\n     * @param {String} name - the provider name will be used to select the provider while instantiating the runner\n     *\n     * @param {Object} provider - the Item Runtime Provider as a plain object. The itemRunner forwards encapsulate and delegate calls to the provider.\n     * @param {InitItemProvider} provider.init - the provider initializes the item from it's data, for example loading libraries, add some listeners, etc.\n     * @param {RenderItemProvider} provider.render - the provider renders the item within the given container element.\n     * @param {ClearItemProvider} [provider.clear] - the provider clears the item.\n     * @param {GetStateItemProvider} [provider.getState] - the provider get the item's state.\n     * @param {SetStateItemProvider} [provider.setState] - the provider restore the item to the given state.\n     * @param {GetRespnsesItemProvider} [provider.getResponses] - the provider gives the current responses.\n     *\n     * @throws TypeError when a wrong provider is given or an empty name.\n     */\n    itemRunnerFactory.register = function registerProvider(name, provider){\n        //type checking\n        if(!_.isString(name) || name.length <= 0){\n            throw new TypeError('It is required to give a name to your provider.');\n        }\n        if(!_.isPlainObject(provider) || (!_.isFunction(provider.init) && !_.isFunction(provider.render))){\n            throw new TypeError('A provider is an object that contains at least an init function or a render function.');\n        }\n\n        this.providers = this.providers || {};\n        this.providers[name] = provider;\n    };\n\n    return itemRunnerFactory;\n});\n\n","define('taoQtiItem/qtiItem/core/qtiClasses',[], function(){\n    return {\n        '_container' : 'taoQtiItem/qtiItem/core/Container',\n        'assessmentItem' : 'taoQtiItem/qtiItem/core/Item',\n        'responseProcessing' : 'taoQtiItem/qtiItem/core/ResponseProcessing',\n        '_simpleFeedbackRule' : 'taoQtiItem/qtiItem/core/response/SimpleFeedbackRule',\n        'stylesheet' : 'taoQtiItem/qtiItem/core/Stylesheet',\n        'math' : 'taoQtiItem/qtiItem/core/Math',\n        'img' : 'taoQtiItem/qtiItem/core/Img',\n        'object' : 'taoQtiItem/qtiItem/core/Object',\n        'outcomeDeclaration' : 'taoQtiItem/qtiItem/core/variables/OutcomeDeclaration',\n        'responseDeclaration' : 'taoQtiItem/qtiItem/core/variables/ResponseDeclaration',\n        'rubricBlock' : 'taoQtiItem/qtiItem/core/RubricBlock',\n        'associableHotspot' : 'taoQtiItem/qtiItem/core/choices/AssociableHotspot',\n        'gap' : 'taoQtiItem/qtiItem/core/choices/Gap',\n        'gapImg' : 'taoQtiItem/qtiItem/core/choices/GapImg',\n        'gapText' : 'taoQtiItem/qtiItem/core/choices/GapText',\n        'hotspotChoice' : 'taoQtiItem/qtiItem/core/choices/HotspotChoice',\n        'hottext' : 'taoQtiItem/qtiItem/core/choices/Hottext',\n        'inlineChoice' : 'taoQtiItem/qtiItem/core/choices/InlineChoice',\n        'simpleAssociableChoice' : 'taoQtiItem/qtiItem/core/choices/SimpleAssociableChoice',\n        'simpleChoice' : 'taoQtiItem/qtiItem/core/choices/SimpleChoice',\n        'associateInteraction' : 'taoQtiItem/qtiItem/core/interactions/AssociateInteraction',\n        'choiceInteraction' : 'taoQtiItem/qtiItem/core/interactions/ChoiceInteraction',\n        'endAttemptInteraction' : 'taoQtiItem/qtiItem/core/interactions/EndAttemptInteraction',\n        'extendedTextInteraction' : 'taoQtiItem/qtiItem/core/interactions/ExtendedTextInteraction',\n        'gapMatchInteraction' : 'taoQtiItem/qtiItem/core/interactions/GapMatchInteraction',\n        'graphicAssociateInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicAssociateInteraction',\n        'graphicGapMatchInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicGapMatchInteraction',\n        'graphicOrderInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicOrderInteraction',\n        'hotspotInteraction' : 'taoQtiItem/qtiItem/core/interactions/HotspotInteraction',\n        'hottextInteraction' : 'taoQtiItem/qtiItem/core/interactions/HottextInteraction',\n        'inlineChoiceInteraction' : 'taoQtiItem/qtiItem/core/interactions/InlineChoiceInteraction',\n        'matchInteraction' : 'taoQtiItem/qtiItem/core/interactions/MatchInteraction',\n        'mediaInteraction' : 'taoQtiItem/qtiItem/core/interactions/MediaInteraction',\n        'orderInteraction' : 'taoQtiItem/qtiItem/core/interactions/OrderInteraction',\n        'prompt' : 'taoQtiItem/qtiItem/core/interactions/Prompt',\n        'selectPointInteraction' : 'taoQtiItem/qtiItem/core/interactions/SelectPointInteraction',\n        'sliderInteraction' : 'taoQtiItem/qtiItem/core/interactions/SliderInteraction',\n        'textEntryInteraction' : 'taoQtiItem/qtiItem/core/interactions/TextEntryInteraction',\n        'uploadInteraction' : 'taoQtiItem/qtiItem/core/interactions/UploadInteraction',\n        'feedbackBlock' : 'taoQtiItem/qtiItem/core/feedbacks/FeedbackBlock',\n        'feedbackInline' : 'taoQtiItem/qtiItem/core/feedbacks/FeedbackInline',\n        'modalFeedback' : 'taoQtiItem/qtiItem/core/feedbacks/ModalFeedback',\n        'customInteraction' : 'taoQtiItem/qtiItem/core/interactions/CustomInteraction',\n        'infoControl' : 'taoQtiItem/qtiItem/core/PortableInfoControl'\n    };\n});\n","/**\n * Common basic util functions\n */\ndefine('taoQtiItem/qtiItem/helper/util',['lodash'], function(_){\n    var util = {\n        buildSerial : function buildSerial(prefix){\n            var id = prefix || '';\n            var chars = \"abcdefghijklmnopqrstuvwxyz0123456789\";\n            for(var i = 0; i < 22; i++){\n                id += chars.charAt(Math.floor(Math.random() * chars.length));\n            }\n            return id;\n        },\n        fullpath : function fullpath(src, baseUrl){\n\n            src = src || '';\n            baseUrl = baseUrl || '';\n\n            if(src){\n\n                src = src.replace(/^\\//, '');\n\n                if(!src.match(/^http/i)){\n\n                    if(baseUrl && !baseUrl.match(/\\/$/)){\n                        baseUrl += '/';\n                    }\n\n                    src = baseUrl + src;\n                }\n            }\n\n            return src;\n        },\n        findInCollection : function findInCollection(element, collectionNames, searchedSerial){\n\n            var found = null;\n\n            if(_.isString(collectionNames)){\n                collectionNames = [collectionNames];\n            }\n\n            if(_.isArray(collectionNames)){\n\n                _.each(collectionNames, function(collectionName){\n\n                    //get collection to search in (resolving case like interaction.choices.0\n                    var collection = element;\n                    _.each(collectionName.split('.'), function(nameToken){\n                        collection = collection[nameToken];\n                    });\n                    var elt = collection[searchedSerial];\n\n                    if(elt){\n                        found = {'parent' : element, 'element' : elt};\n                        return false;//break the each loop\n                    }\n\n                    //search inside each elements:\n                    _.each(collection, function(elt){\n\n                        if(_.isFunction(elt.find)){\n                            found = elt.find(searchedSerial);\n                            if(found){\n                                return false;//break the each loop\n                            }\n                        }\n\n                    });\n\n                    if(found){\n                        return false;//break the each loop\n                    }\n\n                });\n\n            }else{\n\n                throw new Error('invalid argument : collectionNames must be an array or a string');\n            }\n\n            return found;\n        },\n        addMarkupNamespace : function addMarkupNamespace(markup, ns){\n            if(ns) {\n                markup = markup.replace(/<(\\/)?([a-z]+)(\\s?)([^><]*)>/g, '<$1' + ns + ':$2$3$4>');\n                return markup;\n            }\n            return markup;\n\n        },\n        removeMarkupNamespaces : function removeMarkupNamespace(markup){\n            return markup.replace(/<(\\/)?(\\w*):([^>]*)>/g, '<$1$3>');\n        },\n        getMarkupUsedNamespaces : function getMarkupUsedNamespaces(markup){\n            var namespaces = [];\n            markup.replace(/<(\\/)?(\\w*):([^>]*)>/g, function(original, slash, ns, node){\n                namespaces.push(ns);\n                return '<'+slash+node+'>';\n            });\n            return _.uniq(namespaces);\n        }\n    };\n\n    return util;\n});\n","define('taoQtiItem/qtiItem/helper/rendererConfig',['lodash', 'jquery'], function(_, $){\n\n    var rendererConfigHelper = {};\n\n    rendererConfigHelper.getOptionsFromArguments = function(args){\n\n        var options = {\n            data : {},\n            placeholder : null,\n            subclass : '',\n            renderer : null\n        };\n        \n        _.each(args, function(arg){\n            if(arg){\n                if(arg.isRenderer){\n                    options.renderer = arg;\n                }else if(arg instanceof $ && arg.length){\n                    options.placeholder = arg;\n                }else if(_.isString(arg)){\n                    options.subclass = arg;\n                }else if(_.isPlainObject(arg)){\n                    options.data = arg;\n                }else{\n                    console.log('invalid arg', arg, args);\n                }\n            }\n        });\n        \n        return options;\n    };\n    \n    return rendererConfigHelper;\n});\n\n","define('taoQtiItem/qtiItem/core/Element',['jquery', 'class', 'lodash', 'taoQtiItem/qtiItem/helper/util', 'taoQtiItem/qtiItem/helper/rendererConfig'], function($, Class, _, util, rendererConfig){\n\n    var _instances = {};\n\n    var Element = Class.extend({\n        qtiClass : '',\n        serial : '',\n        relatedItem : null,\n        init : function(serial, attributes){\n\n            //init own attributes\n            this.attributes = {};\n\n            //system properties, for item creator internal use only\n            this.metaData = {};\n\n            //init call in the format init(attributes)\n            if(typeof (serial) === 'object'){\n                attributes = serial;\n                serial = '';\n            }\n\n            if(!serial){\n                serial = util.buildSerial(this.qtiClass + '_');\n            }\n\n            if(serial && (typeof serial !== 'string' || !serial.match(/^[a-z_0-9]*$/i))){\n                throw 'invalid QTI serial : (' + (typeof serial) + ') ' + serial;\n            }\n\n            if(!_instances[serial]){\n                _instances[serial] = this;\n                this.serial = serial;\n                this.setAttributes(attributes || {});\n            }else{\n                throw 'a QTI Element with the same serial already exists ' + serial;\n            }\n\n            if(typeof this.initContainer === 'function'){\n                this.initContainer(arguments[2] || '');\n            }\n            if(typeof this.initObject === 'function'){\n                this.initObject();\n            }\n        },\n        is : function(qtiClass){\n            return (qtiClass === this.qtiClass);\n        },\n        placeholder : function(){\n            return '{{' + this.serial + '}}';\n        },\n        getSerial : function(){\n            return this.serial;\n        },\n        getUsedIdentifiers : function(){\n            var usedIds = {};\n            var elts = this.getComposingElements();\n            for(var i in elts){\n                var elt = elts[i];\n                var id = elt.attr('identifier');\n                if(id){\n                    //warning: simplistic implementation, allow only one unique identifier in the item no matter the element class/type\n                    usedIds[id] = elt;\n                }\n            }\n            return usedIds;\n        },\n        attr : function(name, value){\n            if(name){\n                if(value !== undefined){\n                    this.attributes[name] = value;\n                }else{\n                    if(typeof (name) === 'object'){\n                        for(var prop in name){\n                            this.attr(prop, name[prop]);\n                        }\n                    }else if(typeof (name) === 'string'){\n                        if(this.attributes[name] === undefined){\n                            return undefined;\n                        }else{\n                            return this.attributes[name];\n                        }\n                    }\n                }\n            }\n            return this;\n        },\n        data : function(name, value){\n            if(name){\n                if(value !== undefined){\n                    this.metaData[name] = value;\n                    $(document).trigger('metaChange.qti-widget', {element : this, key : name, value : value});\n                }else{\n                    if(typeof (name) === 'object'){\n                        for(var prop in name){\n                            this.data(prop, name[prop]);\n                        }\n                    }else if(typeof (name) === 'string'){\n                        if(this.metaData[name] === undefined){\n                            return undefined;\n                        }else{\n                            return this.metaData[name];\n                        }\n                    }\n                }\n            }\n            return this;\n        },\n        removeData : function(name){\n            delete this.metaData[name];\n            return this;\n        },\n        removeAttr : function(name){\n            return this.removeAttributes(name);\n        },\n        setAttributes : function(attributes){\n            this.attributes = attributes;\n            return this;\n        },\n        getAttributes : function(){\n            return _.clone(this.attributes);\n        },\n        removeAttributes : function(attrNames){\n            if(typeof (attrNames) === 'string'){\n                attrNames = [attrNames];\n            }\n            for(var i in attrNames){\n                delete this.attributes[attrNames[i]];\n            }\n            return this;\n        },\n        getComposingElements : function(){\n            var elts = {};\n            function append(element){\n                elts[element.getSerial()] = element;//pass individual object by ref, instead of the whole list(object)\n                elts = _.extend(elts, element.getComposingElements());\n            }\n            if(typeof this.initContainer === 'function'){\n                append(this.getBody());\n            }\n            if(typeof this.initObject === 'function'){\n                append(this.getObject());\n            }\n            _.each(this.metaData, function(v){\n                if(Element.isA(v, '_container')){\n                    append(v);\n                }else if(_.isArray(v)){\n                    _.each(v, function(v){\n                        if(Element.isA(v, '_container')){\n                            append(v);\n                        }\n                    });\n                }\n            });\n            return elts;\n        },\n        getUsedClasses : function(){\n\n            var ret = [this.qtiClass],\n                composingElts = this.getComposingElements();\n\n            _.each(composingElts, function(elt){\n                ret.push(elt.qtiClass);\n            });\n\n            return _.uniq(ret);\n        },\n        find : function(serial){\n\n            var found = null;\n\n            if(typeof this.initObject === 'function'){\n                var object = this.getObject();\n                if(object.serial === serial){\n                    found = {'parent' : this, 'element' : object, 'location' : 'object'};\n                }\n            }\n\n            if(!found && typeof this.initContainer === 'function'){\n                found = this.getBody().find(serial, this);\n            }\n\n            return found;\n        },\n        parent : function(){\n            var item = this.getRelatedItem();\n            if(item){\n                var found = item.find(this.getSerial());\n                if(found){\n                    return found.parent;\n                }\n            }\n            return null;\n        },\n        setRelatedItem : function(item, recursive){\n\n            recursive = (typeof recursive === 'undefined') ? true : recursive;\n\n            if(Element.isA(item, 'assessmentItem')){\n                this.relatedItem = item;\n                var composingElts = this.getComposingElements();\n                for(var i in composingElts){\n                    composingElts[i].setRelatedItem(item, false);\n                }\n            }\n\n        },\n        getRelatedItem : function(){\n            var ret = null;\n            if(Element.isA(this.relatedItem, 'assessmentItem')){\n                ret = this.relatedItem;\n            }\n            return ret;\n        },\n        setRenderer : function(renderer){\n            if(renderer && renderer.isRenderer){\n                this.renderer = renderer;\n                var elts = this.getComposingElements();\n                for(var serial in elts){\n                    elts[serial].setRenderer(renderer);\n                }\n            }else{\n                throw 'invalid qti rendering engine';\n            }\n        },\n        getRenderer : function(){\n            return this.renderer;\n        },\n        render : function(){\n\n            var args = rendererConfig.getOptionsFromArguments(arguments);\n            var renderer = args.renderer || this.getRenderer();\n\n            var tplData = {},\n                defaultData = {\n                    'tag' : this.qtiClass,\n                    'serial' : this.serial,\n                    'attributes' : this.getAttributes()\n                };\n\n            if(!renderer){\n                throw 'render: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\n            }\n\n            if(typeof this.initContainer === 'function'){\n                defaultData.body = this.getBody().render(renderer);\n            }\n            if(typeof this.initObject === 'function'){\n                defaultData.object = {\n                    attributes : this.object.getAttributes()\n                };\n                defaultData.object.attributes.data = renderer.getAbsoluteUrl(this.object.attr('data'));\n            }\n\n            tplData = _.merge(defaultData, args.data || {});\n            tplData = renderer.getData(this, tplData, args.subclass);\n            var rendering = renderer.renderTpl(this, tplData, args.subclass);\n            if(args.placeholder){\n                args.placeholder.replaceWith(rendering);\n            }\n\n            return rendering;\n        },\n        postRender : function(data, altClassName, renderer){\n\n            renderer = renderer || this.getRenderer();\n\n            if(typeof this.initContainer === 'function'){\n                //post render body element\n                this.getBody().postRender({}, '', renderer);\n            }\n\n            if(renderer){\n                return renderer.postRender(this, data, altClassName);\n            }else{\n                throw 'postRender: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\n            }\n        },\n        getContainer : function($scope, subclass){\n            var renderer = this.getRenderer();\n            if(renderer){\n                return renderer.getContainer(this, $scope, subclass);\n            }else{\n                throw 'getContainer: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\n            }\n        },\n        toArray : function(){\n            var arr = {\n                serial : this.serial,\n                type : this.qtiClass,\n                attributes : this.getAttributes()\n            };\n\n            if(typeof this.initContainer === 'function'){\n                arr.body = this.getBody().toArray();\n            }\n            if(typeof this.initObject === 'function'){\n                arr.object = this.object.toArray();\n            }\n\n            return arr;\n        },\n        isEmpty : function(){\n            //tells whether the element should be considered empty or not, from the rendering point of view\n            return false;\n        },\n        addClass : function(className){\n            var clazz = this.attr('class') || '';\n            if(!_containClass(clazz, className)){\n                this.attr('class', clazz + (clazz.length ? ' ' : '') + className);\n            }\n        },\n        hasClass : function(className){\n            return _containClass(this.attr('class'), className);\n        },\n        removeClass : function(className){\n\n            var clazz = this.attr('class') || '';\n            if(clazz){\n                var regex = new RegExp('(?:^|\\\\s)' + className + '(?:\\\\s|$)', '');\n                clazz = clazz.replace(regex, '').replace(/^\\s+/, '');\n                if(clazz){\n                    this.attr('class', clazz);\n                }else{\n                    this.removeAttr('class');\n                }\n            }\n        },\n        isset : function(){\n            return Element.issetElement(this.serial);\n        },\n        unset : function(){\n            return Element.unsetElement(this.serial);\n        }\n    });\n\n    var _containClass = function(allClassStr, className){\n        var regex = new RegExp('(?:^|\\\\s)' + className + '(?:\\\\s|$)', '');\n        return allClassStr && regex.test(allClassStr);\n    };\n\n    //helpers\n    Element.isA = function(qtiElement, qtiClass){\n        return (qtiElement instanceof Element && qtiElement.is(qtiClass));\n    };\n\n    Element.getElementBySerial = function(serial){\n        return _instances[serial];\n    };\n\n    Element.issetElement = function(serial){\n        return !!_instances[serial];\n    };\n   \n    /**\n     * Unset a registered element from it's serial\n     * @param {String} serial - the element serial\n     * @returns {Boolean} true if unset\n     */ \n    Element.unsetElement = function(serial){\n\n        var element = Element.getElementBySerial(serial);\n\n        if(element){\n\n            var composingElements = element.getComposingElements();\n            _.each(composingElements, function(elt){\n                delete _instances[elt.serial];\n            });\n            delete _instances[element.serial];\n            \n            return true;\n        }\n        return false;\n    };\n\n    return Element;\n});\n\n\n\n","//@todo : move this to the ../helper directory\ndefine('taoQtiItem/qtiItem/core/Loader',['lodash', 'class', 'taoQtiItem/qtiItem/core/qtiClasses', 'taoQtiItem/qtiItem/core/Element'], function(_, Class, qtiClasses, Element){\n\n    var Loader = Class.extend({\n        init : function(item, classesLocation){\n\n            this.qti = {}; //loaded qti classes are store here\n            this.classesLocation = {};\n\n            this.item = item || null;//starts either from scratch or with an existing item object\n            this.setClassesLocation(classesLocation || qtiClasses);//load default location for qti classes model\n        },\n        setClassesLocation : function(qtiClasses){\n            _.extend(this.classesLocation, qtiClasses);\n            return this;\n        },\n        getRequiredClasses : function(data){\n            var ret = [];\n            for(var i in data){\n                if(i === 'qtiClass' && data[i] !== '_container' && i !== 'relatedItem'){//although a _container is a concrete class in TAO, it is not defined in QTI standard\n                    ret.push(data[i]);\n                }else if(typeof(data[i]) === 'object' && i !== 'responseRules'){    //responseRules should'nt be part of the parsing\n                    ret = _.union(ret, this.getRequiredClasses(data[i]));\n                }\n            }\n            return ret;\n        },\n        loadRequiredClasses : function(data, callback, reload){\n\n            var requiredClasses = this.getRequiredClasses(data, reload), required = [];\n\n            for(var i in requiredClasses){\n                var requiredClass = requiredClasses[i];\n                if(this.classesLocation[requiredClass]){\n                    required.push(this.classesLocation[requiredClass]);\n                }else{\n                    throw new Error('missing qti class location declaration : ' + requiredClass);\n                }\n            }\n\n            var _this = this;\n            require(required, function(){\n                _.each(arguments, function(QtiClass){\n                    _this.qti[QtiClass.prototype.qtiClass] = QtiClass;\n                });\n                callback.call(_this, _this.qti);\n            });\n        },\n        getLoadedClasses : function(){\n            return _.keys(this.qti);\n        },\n        loadItemData : function(data, callback){\n\n            var _this = this;\n            _this.loadRequiredClasses(data, function(Qti){\n                var i;\n                if(typeof(data) === 'object' && data.qtiClass === 'assessmentItem'){\n\n                    //unload an item from it's serial (in case of a reload)\n                    if(data.serial){\n                        Element.unsetElement(data.serial);\n                    }\n\n                    _this.item = new Qti.assessmentItem(data.serial, data.attributes || {});\n                    _this.loadContainer(_this.item.getBody(), data.body);\n\n                    for(i in data.outcomes){\n                        var outcome = _this.buildOutcome(data.outcomes[i]);\n                        if(outcome){\n                            _this.item.addOutcomeDeclaration(outcome);\n                        }\n                    }\n                    for(i in data.feedbacks){\n                        var feedback = _this.buildElement(data.feedbacks[i]);\n                        if(feedback){\n                            _this.item.addModalFeedback(feedback);\n                        }\n                    }\n                    for(i in data.stylesheets){\n                        var stylesheet = _this.buildElement(data.stylesheets[i]);\n                        if(stylesheet){\n                            _this.item.addStylesheet(stylesheet);\n                        }\n                    }\n\n                    //important : build responses after all modal feedbacks and outcomes has been loaded, because the simple feedback rules need to reference them\n                    for(i in data.responses){\n                        var response = _this.buildResponse(data.responses[i]);\n                        if(response){\n                            _this.item.addResponseDeclaration(response);\n\n                            var feedbackRules = data.responses[i].feedbackRules;\n                            if(feedbackRules){\n                                _.forIn(feedbackRules, function(fbData, serial){\n                                    response.feedbackRules[serial] = _this.buildSimpleFeedbackRule(fbData);\n                                });\n                            }\n                        }\n                    }\n\n                    if(data.responseProcessing){\n                        _this.item.setResponseProcessing(_this.buildResponseProcessing(data.responseProcessing));\n                    }\n                    _this.item.setNamespaces(data.namespaces);\n                }\n\n                if(typeof(callback) === 'function'){\n                    callback.call(_this, _this.item);\n                }\n            });\n        },\n        loadElement : function(data, callback){\n\n            var _this = this;\n\n            _this.loadRequiredClasses(data, function(Qti){\n\n                var element = _this.buildElement(data);\n\n                if(typeof(callback) === 'function'){\n                    callback.call(_this, element);\n                }\n            });\n        },\n        /**\n         * Load ALL given elements into existing loaded item\n         *\n         * @todo to be renamed to loadItemElements\n         * @param {object} data\n         * @param {function} callback\n         * @returns {undefined}\n         */\n        loadElements : function(data, callback){\n\n            var _this = this;\n\n            if(_this.item){\n\n                this.loadRequiredClasses(data, function(){\n\n                    var allElements = _this.item.getComposingElements();\n\n                    for(var i in data){\n                        var elementData = data[i];\n                        if(elementData && elementData.qtiClass && elementData.serial){\n                            //find and update element\n                            if(allElements[elementData.serial]){\n                                _this.loadElementData(allElements[elementData.serial], elementData);\n                            }\n                        }\n                    }\n\n                    if(typeof(callback) === 'function'){\n                        callback.call(_this, _this.item);\n                    }\n                });\n            }else{\n                throw 'QtiLoader : cannot load elements in empty item';\n            }\n\n        },\n        buildResponse : function(data){\n\n            var response = this.buildElement(data);\n\n            response.template = data.howMatch || null;\n            response.defaultValue = data.defaultValue || null;\n            response.correctResponse = data.correctResponses || null;\n\n            if(_.size(data.mapping)){\n                response.mapEntries = data.mapping;\n            }else if(_.size(data.areaMapping)){\n                response.mapEntries = data.areaMapping;\n            }else{\n                response.mapEntries = {};\n            }\n\n            response.mappingAttributes = data.mappingAttributes || {};\n\n            return response;\n        },\n        buildSimpleFeedbackRule : function(data){\n\n            var feedbackRule = this.buildElement(data);\n\n            if(data.condition){\n                feedbackRule.condition = data.condition;\n            }\n            if(data.comparedValue){\n                feedbackRule.comparedValue = data.comparedValue;\n            }\n\n            feedbackRule.comparedOutcome = this.item.responses[data.comparedOutcome] || null;\n            feedbackRule.feedbackOutcome = this.item.outcomes[data.feedbackOutcome] || null;\n            feedbackRule.feedbackThen = this.item.modalFeedbacks[data.feedbackThen] || null;\n            feedbackRule.feedbackElse = this.item.modalFeedbacks[data.feedbackElse] || null;\n\n            return feedbackRule;\n        },\n        buildOutcome : function(data){\n            var outcome = this.buildElement(data);\n            outcome.defaultValue = data.defaultValue || null;\n            return outcome;\n        },\n        buildResponseProcessing : function(data){\n            var rp = this.buildElement(data);\n            if(data && data.processingType){\n                if(data.processingType === 'custom'){\n                    rp.xml = data.data;\n                    rp.processingType = 'custom';\n                }else{\n                    rp.processingType = 'templateDriven';\n                }\n            }\n            return rp;\n        },\n        loadContainer : function(bodyObject, bodyData){\n            if(!Element.isA(bodyObject, '_container')){\n                throw 'bodyObject must be a QTI Container';\n            }\n\n            if(bodyData && typeof bodyData.body === 'string' && (typeof bodyData.elements === 'array' || typeof bodyData.elements === 'object')){\n                for(var serial in bodyData.elements){\n                    var eltData = bodyData.elements[serial];\n                    //check if class is loaded:\n                    var element = this.buildElement(eltData);\n                    if(element){\n                        bodyObject.setElement(element, bodyData.body);\n                    }\n                }\n                bodyObject.body(bodyData.body);\n            }else{\n                throw 'wrong bodydata format';\n            }\n        },\n        buildElement : function(elementData){\n            var elt = null;\n            if(elementData && elementData.qtiClass && elementData.serial){\n                var className = elementData.qtiClass;\n                if(this.qti[className]){\n                    elt = new this.qti[className](elementData.serial);\n                    this.loadElementData(elt, elementData);\n                }else{\n                    throw 'the qti element class does not exist: ' + className;\n                }\n            }else{\n                throw 'wrong elementData format';\n            }\n            return elt;\n        },\n        loadElementData : function(element, data){\n\n            element.setAttributes(_.clone(data.attributes) || {});\n\n            if(element.body && data.body){\n                if(element.bdy){\n                    this.loadContainer(element.getBody(), data.body);\n                }\n            }\n\n            if(element.object && data.object){\n                if(element.object){\n                    this.loadObjectData(element.object, data.object);\n                }\n            }\n\n            if(Element.isA(element, 'interaction')){\n                this.loadInteractionData(element, data);\n            }else if(Element.isA(element, 'choice')){\n                this.loadChoiceData(element, data);\n            }else if(Element.isA(element, 'math')){\n                this.loadMathData(element, data);\n            }else if(Element.isA(element, 'infoControl')){\n                this.loadPicData(element, data);\n            }\n\n            return element;\n        },\n        loadInteractionData : function(interaction, data){\n            if(Element.isA(interaction, 'blockInteraction')){\n                if(data.prompt){\n                    this.loadContainer(interaction.prompt.getBody(), data.prompt);\n                }\n            }\n\n            this.buildInteractionChoices(interaction, data);\n\n            if(Element.isA(interaction, 'customInteraction')){\n                this.loadPciData(interaction, data);\n            }\n        },\n        buildInteractionChoices : function(interaction, data){\n\n            //note: Qti.ContainerInteraction (Qti.GapMatchInteraction and Qti.HottextInteraction) has already been parsed by builtElement(interacionData);\n            if(data.choices){\n                if(Element.isA(interaction, 'matchInteraction')){\n                    for(var set = 0; set < 2; set++){\n                        if(!data.choices[set]){\n                            throw 'missing match set #' + set;\n                        }\n                        var matchSet = data.choices[set];\n                        for(var serial in matchSet){\n                            var choice = this.buildElement(matchSet[serial]);\n                            if(choice){\n                                interaction.addChoice(choice, set);\n                            }\n                        }\n                    }\n                }else{\n                    for(var serial in data.choices){\n                        var choice = this.buildElement(data.choices[serial]);\n                        if(choice){\n                            interaction.addChoice(choice);\n                        }\n                    }\n                }\n\n                if(Element.isA(interaction, 'graphicGapMatchInteraction')){\n                    if(data.gapImgs){\n                        for(var serial in data.gapImgs){\n                            var gapImg = this.buildElement(data.gapImgs[serial]);\n                            if(gapImg){\n                                interaction.addGapImg(gapImg);\n                            }\n                        }\n                    }\n                }\n\n            }\n\n        },\n        loadChoiceData : function(choice, data){\n            if(Element.isA(choice, 'textVariableChoice')){\n                choice.val(data.text);\n            }else if(Element.isA(choice, 'gapImg')){\n                //has already been taken care of in buildElement()\n            }else if(Element.isA(choice, 'containerChoice')){\n                //has already been taken care of in buildElement()\n            }\n        },\n        loadObjectData : function(object, data){\n            object.setAttributes(data.attributes);\n            //@todo: manage object like a container\n            if(data._alt){\n                if(data._alt.qtiClass === 'object'){\n                    object._alt = Loader.buildElement(data._alt);\n                }else{\n                    object._alt = data._alt;\n                }\n            }\n        },\n        loadMathData : function(math, data){\n            math.ns = data.ns || {};\n            math.setMathML(data.mathML || '');\n            math.annotations = data.annotations || {};\n        },\n        loadPciData : function(pci, data){\n            loadPortableCustomElementData(pci, data);\n        },\n        loadPicData : function(pic, data){\n            loadPortableCustomElementData(pic, data);\n        }\n    });\n\n    function loadPortableCustomElementData(portableElement, data){\n        portableElement.typeIdentifier = data.typeIdentifier;\n        portableElement.markup = data.markup;\n        portableElement.entryPoint = data.entryPoint;\n        portableElement.properties = data.properties;\n        portableElement.libraries = data.libraries;\n    }\n\n    return Loader;\n});\n\n","/**\n * Common helper functions\n */\ndefine('taoQtiItem/qtiItem/helper/interactionHelper',['lodash', 'taoQtiItem/qtiItem/core/Element'], function(_, Element){\n    return {\n        convertChoices : function(choices, outputType){\n\n            var ret = [], _this = this;\n\n            _.each(choices, function(c){\n                if(Element.isA(c, 'choice')){\n                    switch(outputType){\n                        case 'serial':\n                            ret.push(c.getSerial());\n                            break;\n                        case 'identifier':\n                            ret.push(c.id());\n                            break;\n                        default:\n                            ret.push(c);\n                    }\n\n                }else if(_.isArray(c)){\n                    ret.push(_this.convertChoices(c, outputType));\n                }\n            });\n\n            return ret;\n        },\n        findChoices : function(interaction, choices, inputType){\n\n            var ret = [], _this = this;\n\n            _.each(choices, function(c){\n                var choice;\n                if(_.isString(c)){\n                    if(inputType === 'serial'){\n                        choice = interaction.getChoice(c);\n                        if(choice){\n                            ret.push(choice);\n                        }\n                    }else if(inputType === 'identifier'){\n                        choice = interaction.getChoiceByIdentifier(c);\n                        if(choice){\n                            ret.push(choice);\n                        }\n                    }else{\n                        ret.push(c);\n                    }\n                }else if(_.isArray(c)){\n                    ret.push(_this.findChoices(interaction, c, inputType));\n                }else{\n                    ret.push(c);\n                }\n            });\n\n            return ret;\n        },\n        shuffleChoices : function(choices){\n            var r = [], //returned array\n                f = {}, //fixed choices array\n                j = 0;\n\n            for(var i in choices){\n                if(Element.isA(choices[i], 'choice')){\n                    var choice = choices[i];\n                    if(choice.attr('fixed')){\n                        f[j] = choice;\n                    }\n                    r.push(choice);\n                    j++;\n                }else{\n                    throw 'invalid element in array: is not a qti choice';\n                }\n            }\n\n            for(var n = 0; n < r.length - 1; n++){\n                if(f[n]){\n                    continue;\n                }\n                var k = -1;\n                do{\n                    k = n + Math.floor(Math.random() * (r.length - n));\n                }while(f[k]);\n                var tmp = r[k];\n                r[k] = r[n];\n                r[n] = tmp;\n            }\n\n            return r;\n        },\n        serialToIdentifier : function(interaction, choiceSerial){\n            var choice = interaction.getChoice(choiceSerial);\n            if(choice){\n                return choice.id();\n            }else{\n                return '';\n            }\n        }\n    }\n});\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\n *\n */\n\n/**\n * A factory to create a QTI renderer.\n *\n * @author Sam Sipasseuth <sam@taotesting.com>\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiItem/qtiRunner/core/Renderer',[\n    'lodash',\n    'jquery',\n    'handlebars',\n    'taoQtiItem/qtiItem/core/Element',\n    'taoQtiItem/qtiItem/helper/interactionHelper'\n], function(_, $, Handlebars, Element, interactionHelper){\n    'use strict';\n\n    var _isValidRenderer = function(renderer){\n\n        var valid = true;\n\n        if(typeof (renderer) !== 'object'){\n            return false;\n        }\n\n        var classCorrect = false;\n        if(renderer.qtiClass){\n            if(_.indexOf(_renderableClasses, renderer.qtiClass) >= 0){\n                classCorrect = true;\n            }else{\n                var pos = renderer.qtiClass.indexOf('.');\n                if(pos > 0){\n                    var qtiClass = renderer.qtiClass.slice(0, pos);\n                    var subClass = renderer.qtiClass.slice(pos + 1);\n                    if(_renderableSubclasses[qtiClass] && _.indexOf(_renderableSubclasses[qtiClass], subClass) >= 0){\n                        classCorrect = true;\n                    }\n                }\n            }\n        }\n        if(!classCorrect){\n            valid = false;\n            throw new Error('invalid qti class name in renderer declaration : ' + renderer.qtiClass);\n        }\n\n        if(!renderer.template){\n            valid = false;\n            throw new Error('missing template in renderer declaration : ' + renderer.qtiClass);\n        }\n\n        return valid;\n    };\n\n    var _renderableClasses = [\n        '_container',\n        'assessmentItem',\n        'stylesheet',\n        'responseDeclaration',\n        'outcomeDeclaration',\n        'responseProcessing',\n        '_simpleFeedbackRule',\n        'img',\n        'math',\n        'object',\n        'modalFeedback',\n        'rubricBlock',\n        'associateInteraction',\n        'choiceInteraction',\n        'extendedTextInteraction',\n        'gapMatchInteraction',\n        'graphicAssociateInteraction',\n        'graphicGapMatchInteraction',\n        'graphicOrderInteraction',\n        'hotspotInteraction',\n        'hottextInteraction',\n        'inlineChoiceInteraction',\n        'matchInteraction',\n        'mediaInteraction',\n        'orderInteraction',\n        'selectPointInteraction',\n        'sliderInteraction',\n        'textEntryInteraction',\n        'uploadInteraction',\n        'endAttemptInteraction',\n        'customInteraction',\n        'prompt',\n        'associableHotspot',\n        'gap',\n        'gapImg',\n        'gapText',\n        'hotspotChoice',\n        'hottext',\n        'inlineChoice',\n        'simpleAssociableChoice',\n        'simpleChoice',\n        'infoControl'\n    ];\n\n    var _dependencies = {\n        assessmentItem : ['stylesheet', '_container', 'prompt', 'modalFeedback'],\n        rubricBlock : ['_container'],\n        associateInteraction : ['simpleAssociableChoice'],\n        choiceInteraction : ['simpleChoice'],\n        gapMatchInteraction : ['gap', 'gapText'],\n        graphicAssociateInteraction : ['associableHotspot'],\n        graphicGapMatchInteraction : ['associableHotspot', 'gapImg'],\n        graphicOrderInteraction : ['hotspotChoice'],\n        hotspotInteraction : ['hotspotChoice'],\n        hottextInteraction : ['hottext'],\n        inlineChoiceInteraction : ['inlineChoice'],\n        matchInteraction : ['simpleAssociableChoice'],\n        orderInteraction : ['simpleChoice']\n    };\n\n    var _renderableSubclasses = {\n        'simpleAssociableChoice' : ['associateInteraction', 'matchInteraction'],\n        'simpleChoice' : ['choiceInteraction', 'orderInteraction']\n    };\n\n    /**\n     * Get the location of the document, useful to define a baseUrl for the required context\n     * @returns {String}\n     */\n    function getDocumentBaseUrl(){\n        return window.location.protocol + '//' + window.location.host + window.location.pathname.replace(/([^\\/]*)$/, '');\n    }\n\n    /**\n     * The built Renderer class\n     * @constructor\n     * @param {Object} [options] - the renderer options\n     * @param {Object} [options.decorators] - to set up rendering decorator\n     * @param {preRenderDecorator} [options.decorators.before] - to set up a pre decorator\n     * @param {postRenderDecorator} [options.decorators.after] - to set up a post decorator\n     */\n    var Renderer = function(options){\n\n        options = options || {};\n\n        this.isRenderer = true;\n        this.name = '';\n        this.shuffleChoices = (options.shuffleChoices !== undefined) ? options.shuffleChoices : true;\n\n        //store shuffled choice here\n        this.shuffledChoices = [];\n\n        /**\n         * Store the registered renderer location\n         */\n        var _locations = {};\n\n        /**\n         * Store loaded renderers\n         */\n        var _renderers = {};\n\n        /**\n         * Get the actual renderer of the give qti class or subclass:\n         * e.g. simplceChoice, simpleChoice.choiceInteraction, simpleChoice.orderInteraction\n         */\n        var _getClassRenderer = function(qtiClass){\n            var ret = null;\n            if(_renderers[qtiClass]){\n                ret = _renderers[qtiClass];\n            }else{\n                var pos = qtiClass.indexOf('.');\n                if(pos > 0){\n                    qtiClass = qtiClass.slice(0, pos);\n                    if(_renderers[qtiClass]){\n                        ret = _renderers[qtiClass];\n                    }\n                }\n            }\n            return ret;\n        };\n\n        /**\n         * Set the renderer options\n         * @param {String} key - the name of the option\n         * @param {*} value - the option vallue\n         * @returns {Renderer} for chaining\n         */\n        this.setOption = function(key, value){\n            if(typeof (key) === 'string'){\n                options[key] = value;\n            }\n            return this;\n        };\n\n        /**\n         * Set the renderer options\n         * @param {Object} opts - the options\n         * @returns {Renderer} for chaining\n         */\n        this.setOptions = function(opts){\n            _.extend(options, opts);\n            return this;\n        };\n\n        /**\n         * Get the renderer option\n         * @param {String} key - the name of the option\n         * @returns {*|null} the option vallue\n         */\n        this.getOption = function(key){\n            if(typeof (key) === 'string' && options[key]){\n                return options[key];\n            }\n            return null;\n        };\n\n        /**\n         * Renders the template\n         * @param {Object} element - the QTI model element\n         * @param {Object} data - the data to give to the template\n         * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\n         * @returns {String} the template results\n         * @throws {Error} if the renderer is not set or has no template bound\n         */\n        this.renderTpl = function(element, data, qtiSubclass){\n\n            var res;\n            var ret        = '';\n            var tplFound   = false;\n            var qtiClass   = qtiSubclass || element.qtiClass;\n            var renderer   = _getClassRenderer(qtiClass);\n            var decorators = this.getOption('decorators');\n\n            if(!renderer && !_.isFunction(renderer.template)){\n                throw new Error('no renderer template loaded under the class name : ' + qtiClass);\n            }\n\n            //pre rendering decoration\n            if(_.isObject(decorators) && _.isFunction(decorators.before)){\n\n                /**\n                 * @callback preRenderDecoractor\n                 * @param {Object} element - the QTI model element\n                 * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\n                 * @returns {String} the decorator result\n                 */\n                res = decorators.before(element, qtiSubclass);\n                if(_.isString(res)){\n                    ret += res;\n                }\n            }\n\n            //render the template\n            ret += renderer.template(data);\n\n\n            //post rendering decoration\n            if(_.isObject(decorators) && _.isFunction(decorators.after)){\n\n                /**\n                 * @callback postRenderDecoractor\n                 * @param {Object} element - the QTI model element\n                 * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\n                 * @returns {String} the decorator result\n                 */\n                res = decorators.after(element, qtiSubclass);\n                if(_.isString(res)){\n                    ret += res;\n                }\n            }\n            return ret;\n        };\n\n        this.getData = function(element, data, qtiSubclass){\n\n            var ret = data,\n                qtiClass = qtiSubclass || element.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.getData) === 'function'){\n                    ret = renderer.getData.call(this, element, data);\n                }\n            }\n\n            return ret;\n        };\n\n        this.renderDirect = function(tpl, data){\n            return Handlebars.compile(tpl)(data);\n        };\n\n        this.getContainer = function(qtiElement, $scope, qtiSubclass){\n\n            var ret = null,\n                qtiClass = qtiSubclass || qtiElement.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                ret = renderer.getContainer(qtiElement, $scope);\n            }else{\n                throw 'no renderer found for the class : ' + qtiElement.qtiClass;\n            }\n            return ret;\n        };\n\n        this.postRender = function(qtiElement, data, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiElement.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.render) === 'function'){\n                    ret = renderer.render.call(this, qtiElement, data);\n                }\n                //postRendering is optional, log missing call of postRender?\n            }\n\n            return ret;\n        };\n\n        this.setResponse = function(qtiInteraction, response, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.setResponse) === 'function'){\n                    ret = renderer.setResponse.call(this, qtiInteraction, response);\n                    var $container = renderer.getContainer.call(this, qtiInteraction);\n                    if($container instanceof $ && $container.length){\n                        $container.trigger('responseSet', [qtiInteraction, response]);\n                    }\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        this.getResponse = function(qtiInteraction, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.getResponse) === 'function'){\n                    ret = renderer.getResponse.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        this.resetResponse = function(qtiInteraction, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.resetResponse) === 'function'){\n                    ret = renderer.resetResponse.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        /**\n         * Retrieve the state of the interaction.\n         * If the renderer has no state management, it falls back to the response management.\n         *\n         * @param {Object} qtiInteraction - the interaction\n         * @param {String} [qtiSubClass] - (not sure of the type and how it is used - Sam ? )\n         * @returns {Object} the interaction's state\n         *\n         * @throws {Error} if no renderer is registered\n         */\n        this.getState = function(qtiInteraction, qtiSubclass){\n\n            var ret = false;\n            var qtiClass = qtiSubclass || qtiInteraction.qtiClass;\n            var renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(_.isFunction(renderer.getState)){\n                    ret = renderer.getState.call(this, qtiInteraction);\n                } else {\n                    ret = renderer.getResponse.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        /**\n         * Retrieve the state of the interaction.\n         * If the renderer has no state management, it falls back to the response management.\n         *\n         * @param {Object} qtiInteraction - the interaction\n         * @param {Object} state - the interaction's state\n         * @param {String} [qtiSubClass] - (not sure of the type and how it is used - Sam ? )\n         *\n         * @throws {Error} if no renderer is found\n         */\n        this.setState =  function(qtiInteraction, state, qtiSubclass){\n\n            var qtiClass = qtiSubclass || qtiInteraction.qtiClass;\n            var renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(_.isFunction(renderer.setState)){\n                    renderer.setState.call(this, qtiInteraction, state);\n                } else {\n                    renderer.resetResponse.call(this, qtiInteraction);\n                    renderer.setResponse.call(this, qtiInteraction, state);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n        };\n\n        /**\n         * Calls the renderer destroy.\n         * Ask the renderer to run destroy if exists.\n         *\n         * @throws {Error} if no renderer is found\n         */\n        this.destroy = function(qtiInteraction, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(_.isFunction(renderer.destroy)){\n                    ret = renderer.destroy.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        this.getLoadedRenderers = function(){\n            return _renderers;\n        };\n\n        this.register = function(renderersLocations){\n            _.extend(_locations, renderersLocations);\n        };\n\n        this.load = function(callback, requiredClasses){\n           var self = this;\n            var required = [];\n            if(requiredClasses){\n                if(_.isArray(requiredClasses)){\n\n                    //exclude abstract classes\n                    requiredClasses = _.intersection(requiredClasses, _renderableClasses);\n\n                    //add dependencies\n                    _.each(requiredClasses, function(reqClass){\n                        var deps = _dependencies[reqClass];\n                        if(deps){\n                            requiredClasses = _.union(requiredClasses, deps);\n                        }\n                    });\n\n                    _.forEach(requiredClasses, function(qtiClass){\n\n                        if(_renderableSubclasses[qtiClass]){\n                            var requiredSubClasses = _.intersection(requiredClasses, _renderableSubclasses[qtiClass]);\n                            _.each(requiredSubClasses, function(subclass){\n                                if(_locations[qtiClass + '.' + subclass]){\n                                    required.push(_locations[qtiClass + '.' + subclass]);\n                                }else if(_locations[qtiClass]){\n                                    required.push(_locations[qtiClass]);\n                                }else{\n                                    throw new Error(self.name + ' : missing qti class location declaration: ' + qtiClass + ', subclass: ' + subclass);\n                                }\n                            });\n                        } else {\n                            if(_locations[qtiClass] === false){\n                                _renderers[qtiClass] = false;//mark this class as not renderable\n                            }else if(_locations[qtiClass]){\n                                required.push(_locations[qtiClass]);\n                            }else{\n                                throw new Error(self.name + ' : missing qti class location declaration: ' + qtiClass);\n                            }\n                        }\n                    });\n                } else {\n                    throw new Error('invalid argument type: expected array for arg \"requireClasses\"');\n                }\n\n            }else{\n                required = _.values(_locations);\n            }\n\n            var _this = this;\n            require(required, function(){\n\n                _.each(arguments, function(clazz){\n                    if(_isValidRenderer(clazz)){\n                        _renderers[clazz.qtiClass] = clazz;\n                    }\n                });\n\n                if(typeof (callback) === 'function'){\n                    callback.call(_this, _renderers);\n                }\n            });\n\n            return this;\n        };\n\n        /**\n         * Define the shuffling manually\n         *\n         * @param {Object} interaction - the interaction\n         * @param {Array} choices - the shuffled choices\n         * @param {String} identificationType -\n         */\n        this.setShuffledChoices = function(interaction, choices, identificationType){\n            if(Element.isA(interaction, 'interaction')){\n                this.shuffledChoices[interaction.getSerial()] = _.pluck(interactionHelper.findChoices(interaction, choices, identificationType), 'serial');\n            }\n        };\n\n        /**\n         * Get the choices shuffled for this interaction.\n         *\n         * @param {Object} interaction - the interaction\n         * @param {Boolean} reshuffle - by default choices are shuffled only once and store, but if true you can force shuffling again\n         * @param {String} returnedType - the choice type\n         * @returns {Array} the choices\n         */\n        this.getShuffledChoices = function(interaction, reshuffle, returnedType){\n            var choices = [];\n            var shuffled = [];\n            var serial, i;\n\n            if(Element.isA(interaction, 'interaction')){\n                serial = interaction.getSerial();\n\n                //1st time, we shuffle (or asked to force shuffling)\n                if(!this.shuffledChoices[serial] || reshuffle){\n                    if(Element.isA(interaction, 'matchInteraction')){\n                        this.shuffledChoices[serial] = [];\n                        for(i = 0; i < 2; i++){\n                            choices[i] = interactionHelper.shuffleChoices(interaction.getChoices(i));\n                            this.shuffledChoices[serial][i] = _.pluck(choices[i], 'serial');\n                        }\n                    } else {\n                        choices = interactionHelper.shuffleChoices(interaction.getChoices());\n                        this.shuffledChoices[serial] = _.pluck(choices, 'serial');\n                    }\n\n                //otherwise get the choices from the serials\n                } else {\n                    if(Element.isA(interaction, 'matchInteraction')){\n                        _.forEach(choices, function(choice, index){\n                            if(index < 2){\n                                _.forEach(this.shuffledChoices[serial][i], function(choiceSerial){\n                                    choice.push(interaction.getChoice(choiceSerial));\n                                });\n                            }\n                        });\n                    } else {\n                        _.forEach(this.shuffledChoices[serial], function(choiceSerial){\n                            choices.push(interaction.getChoice(choiceSerial));\n                        });\n                    }\n                }\n\n                //do some type convertion\n                if(returnedType === 'serial' || returnedType === 'identifier'){\n                    return interactionHelper.convertChoices(choices, returnedType);\n                }\n\n                //pass value only, not ref\n                return _.clone(choices);\n            }\n\n            return [];\n        };\n\n        this.getRenderers = function(){\n            return _renderers;\n        };\n\n        this.getLocations = function(){\n            return _locations;\n        };\n\n        this.getAbsoluteUrl = function(relUrl){\n\n            //allow relative url outpu only if explicitely said so\n            if(this.getOption('userRelativeUrl')){\n                return relUrl.replace(/^\\.?\\//, '');\n            }\n\n            if(/^http(s)?:\\/\\//i.test(relUrl)){\n                //already absolute\n                return relUrl;\n            }else{\n\n                var absUrl = '';\n                var runtimeLocations = this.getOption('runtimeLocations');\n\n                if(runtimeLocations && _.size(runtimeLocations)){\n                    _.forIn(runtimeLocations, function(runtimeLocation, typeIdentifier){\n                        if(relUrl.indexOf(typeIdentifier) === 0){\n                            absUrl = relUrl.replace(typeIdentifier, runtimeLocation);\n                            return false;//break\n                        }\n                    });\n                }\n\n                if(absUrl){\n                    return absUrl;\n                }else{\n                    var baseUrl = this.getOption('baseUrl') || getDocumentBaseUrl();\n                    return baseUrl + relUrl;\n                }\n\n            }\n        };\n    };\n\n    return {\n        build : function(renderersLocations, name, defaultOptions){\n            var NewRenderer = function(){\n                Renderer.apply(this, arguments);\n                this.register(renderersLocations);\n                this.name = name || '';\n                if(defaultOptions){\n                    this.setOptions(defaultOptions);\n                }\n            };\n            NewRenderer.prototype = Renderer.prototype;\n            return NewRenderer;\n        }\n    };\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n *\n */\n\n/**\n * The QTI Print renderer configuration\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiPrint/qtiPrintRenderer/renderers/config',[], function(){\n    'use strict';\n\n    /**\n     * @exports taoQtiPrint/qtiPrintRenderer/renderers/config\n     */\n    return {\n        name        : 'printRenderer',\n        locations   : {\n            'assessmentItem':                              'taoQtiPrint/qtiPrintRenderer/renderers/Item',\n            '_container':                                  'taoQtiPrint/qtiPrintRenderer/renderers/Container',\n            'stylesheet':                                  'taoQtiPrint/qtiPrintRenderer/renderers/Stylesheet',\n            'img':                                         'taoQtiPrint/qtiPrintRenderer/renderers/Img',\n            'rubricBlock':                                 'taoQtiPrint/qtiPrintRenderer/renderers/RubricBlock',\n            'object':                                      'taoQtiPrint/qtiPrintRenderer/renderers/Object',\n            'prompt':                                      'taoQtiPrint/qtiPrintRenderer/renderers/interactions/Prompt',\n            'choiceInteraction':                           'taoQtiPrint/qtiPrintRenderer/renderers/interactions/ChoiceInteraction',\n            'extendedTextInteraction':                     'taoQtiPrint/qtiPrintRenderer/renderers/interactions/ExtendedTextInteraction',\n            'textEntryInteraction':                        'taoQtiPrint/qtiPrintRenderer/renderers/interactions/TextEntryInteraction',\n            'simpleChoice.choiceInteraction':              'taoQtiPrint/qtiPrintRenderer/renderers/choices/SimpleChoice.ChoiceInteraction',\n\n//do not print\n            '_simpleFeedbackRule':                         false,\n            'outcomeDeclaration':                          false,\n            'responseDeclaration':                         false,\n            'responseProcessing':                          false,\n            'modalFeedback':                               false,\n\n//not implemented\n            'orderInteraction':                            false,\n            'associateInteraction':                        false,\n            'matchInteraction':                            false,\n            'sliderInteraction':                           false,\n            'simpleChoice.orderInteraction':               false,\n            'hottext':                                     false,\n            'gap':                                         false,\n            'gapText':                                     false,\n            'simpleAssociableChoice.matchInteraction':     false,\n            'simpleAssociableChoice.associateInteraction': false,\n            'hottextInteraction':                          false,\n            'hotspotInteraction':                          false,\n            'gapMatchInteraction':                         false,\n            'inlineChoiceInteraction':                     false,\n            'inlineChoice':                                false,\n            'selectPointInteraction':                      false,\n            'graphicOrderInteraction':                     false,\n            'mediaInteraction':                            false,\n            'uploadInteraction':                           false,\n            'graphicGapMatchInteraction':                  false,\n            'gapImg':                                      false,\n            'graphicAssociateInteraction':                 false,\n            'customInteraction':                           false,\n            'infoControl':                                 false,\n            'endAttemptInteraction':                       false,\n        }\n    };\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n\n/**\n * The QTI Print renderer built using the print config\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiPrint/qtiPrintRenderer/renderers/Renderer',[\n    'taoQtiItem/qtiRunner/core/Renderer',\n    'taoQtiPrint/qtiPrintRenderer/renderers/config',\n    'css!taoQtiPrintCss/qti.css'\n], function(Renderer, config){\n    'use strict';\n\n    /**\n     * Build and expost the printRenderer\n     * @exports taoQtiPrint/qtiPrintRenderer/renderers/config\n     */\n    return Renderer.build(config.locations, config.name);\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\n *\n */\n\n/**\n * Item Runner for printed items\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiPrint/runner/provider/qtiprint',[\n    'helpers',\n    'taoQtiItem/qtiItem/core/Loader',\n    'taoQtiPrint/qtiPrintRenderer/renderers/Renderer'],\nfunction(helpers, QtiLoader, QtiRenderer){\n    'use strict';\n\n    /**\n     * @exports taoQtiPrint/runner/provider/qtiprint\n     */\n    var qtiItemRuntimeProvider = {\n\n        init : function init (itemData, done){\n            var self = this;\n\n            //TODO configure the renderer URLs using an AssetManager\n            this._renderer = new QtiRenderer({\n                baseUrl : helpers._url('getFile', 'QtiCreator', 'taoQtiItem', {uri : this.options.uri, lang : 'en-US'}) + '&relPath='\n            });\n\n            new QtiLoader().loadItemData(itemData, function(item){\n                if(!item){\n                    return self.trigger('error', 'Unable to load item from the given data.');\n                }\n\n                self._item = item;\n                try{\n                    self._renderer.load(function(){\n                        self._item.setRenderer(this);\n\n                        done();\n                    }, this.getLoadedClasses());\n                } catch(e){\n                    self.trigger('error', 'Unable to render the item : ' + e);\n                }\n            });\n\n        },\n\n        render : function render (elt, done){\n            var self = this;\n            if(this._item){\n                try {\n                    elt.innerHTML = this._item.render({});\n                } catch(e){\n                    console.error(e);\n                    self.trigger('error', 'Error in template rendering : ' +  e);\n                }\n                try {\n                    this._item.postRender();\n                } catch(e){\n                    console.error(e);\n                    self.trigger('error', 'Error in post rendering : ' +  e);\n                }\n                done();\n            }\n        },\n\n        clear : function clear (elt, done){\n            done();\n        },\n\n        getState : function getState (){\n            return {};\n        },\n\n        setState : function setState (state){ },\n\n        getResponses : function getResponses (){\n            return [];\n        }\n    };\n\n    return qtiItemRuntimeProvider;\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\n *\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiPrint/runner/itemRunner',[\n    'taoItems/runner/api/itemRunner',\n    'taoQtiPrint/runner/provider/qtiprint'\n], function(itemRunner, qtiRuntimeProvider){\n    'use strict';\n\n    //register the QTI Provider\n    itemRunner.register('qtiprint', qtiRuntimeProvider);\n\n    /**\n     * Expose the itemRunner with the QTI provider registered\n     * @exports taoQtiPrint/runner/itemRunner\n     */\n    return itemRunner;\n});\n\n","/**\n * @fileoverview\n * - Using the 'QRCode for Javascript library'\n * - Fixed dataset of 'QRCode for Javascript library' for support full-spec.\n * - this library has no dependencies.\n * \n * @author davidshimjs\n * @see <a href=\"http://www.d-project.com/\" target=\"_blank\">http://www.d-project.com/</a>\n * @see <a href=\"http://jeromeetienne.github.com/jquery-qrcode/\" target=\"_blank\">http://jeromeetienne.github.com/jquery-qrcode/</a>\n */\n define('taoQtiPrint/lib/qrcode',[], function(){\nvar QRCode;\n\n\t//---------------------------------------------------------------------\n\t// QRCode for JavaScript\n\t//\n\t// Copyright (c) 2009 Kazuhiko Arase\n\t//\n\t// URL: http://www.d-project.com/\n\t//\n\t// Licensed under the MIT license:\n\t//   http://www.opensource.org/licenses/mit-license.php\n\t//\n\t// The word \"QR Code\" is registered trademark of \n\t// DENSO WAVE INCORPORATED\n\t//   http://www.denso-wave.com/qrcode/faqpatent-e.html\n\t//\n\t//---------------------------------------------------------------------\n\tfunction QR8bitByte(data) {\n\t\tthis.mode = QRMode.MODE_8BIT_BYTE;\n\t\tthis.data = data;\n\t\tthis.parsedData = [];\n\n\t\t// Added to support UTF-8 Characters\n\t\tfor (var i = 0, l = this.data.length; i < l; i++) {\n\t\t\tvar byteArray = [];\n\t\t\tvar code = this.data.charCodeAt(i);\n\n\t\t\tif (code > 0x10000) {\n\t\t\t\tbyteArray[0] = 0xF0 | ((code & 0x1C0000) >>> 18);\n\t\t\t\tbyteArray[1] = 0x80 | ((code & 0x3F000) >>> 12);\n\t\t\t\tbyteArray[2] = 0x80 | ((code & 0xFC0) >>> 6);\n\t\t\t\tbyteArray[3] = 0x80 | (code & 0x3F);\n\t\t\t} else if (code > 0x800) {\n\t\t\t\tbyteArray[0] = 0xE0 | ((code & 0xF000) >>> 12);\n\t\t\t\tbyteArray[1] = 0x80 | ((code & 0xFC0) >>> 6);\n\t\t\t\tbyteArray[2] = 0x80 | (code & 0x3F);\n\t\t\t} else if (code > 0x80) {\n\t\t\t\tbyteArray[0] = 0xC0 | ((code & 0x7C0) >>> 6);\n\t\t\t\tbyteArray[1] = 0x80 | (code & 0x3F);\n\t\t\t} else {\n\t\t\t\tbyteArray[0] = code;\n\t\t\t}\n\n\t\t\tthis.parsedData.push(byteArray);\n\t\t}\n\n\t\tthis.parsedData = Array.prototype.concat.apply([], this.parsedData);\n\n\t\tif (this.parsedData.length != this.data.length) {\n\t\t\tthis.parsedData.unshift(191);\n\t\t\tthis.parsedData.unshift(187);\n\t\t\tthis.parsedData.unshift(239);\n\t\t}\n\t}\n\n\tQR8bitByte.prototype = {\n\t\tgetLength: function (buffer) {\n\t\t\treturn this.parsedData.length;\n\t\t},\n\t\twrite: function (buffer) {\n\t\t\tfor (var i = 0, l = this.parsedData.length; i < l; i++) {\n\t\t\t\tbuffer.put(this.parsedData[i], 8);\n\t\t\t}\n\t\t}\n\t};\n\n\tfunction QRCodeModel(typeNumber, errorCorrectLevel) {\n\t\tthis.typeNumber = typeNumber;\n\t\tthis.errorCorrectLevel = errorCorrectLevel;\n\t\tthis.modules = null;\n\t\tthis.moduleCount = 0;\n\t\tthis.dataCache = null;\n\t\tthis.dataList = [];\n\t}\n\n\tQRCodeModel.prototype={addData:function(data){var newData=new QR8bitByte(data);this.dataList.push(newData);this.dataCache=null;},isDark:function(row,col){if(row<0||this.moduleCount<=row||col<0||this.moduleCount<=col){throw new Error(row+\",\"+col);}\n\treturn this.modules[row][col];},getModuleCount:function(){return this.moduleCount;},make:function(){this.makeImpl(false,this.getBestMaskPattern());},makeImpl:function(test,maskPattern){this.moduleCount=this.typeNumber*4+17;this.modules=new Array(this.moduleCount);for(var row=0;row<this.moduleCount;row++){this.modules[row]=new Array(this.moduleCount);for(var col=0;col<this.moduleCount;col++){this.modules[row][col]=null;}}\n\tthis.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupPositionAdjustPattern();this.setupTimingPattern();this.setupTypeInfo(test,maskPattern);if(this.typeNumber>=7){this.setupTypeNumber(test);}\n\tif(this.dataCache==null){this.dataCache=QRCodeModel.createData(this.typeNumber,this.errorCorrectLevel,this.dataList);}\n\tthis.mapData(this.dataCache,maskPattern);},setupPositionProbePattern:function(row,col){for(var r=-1;r<=7;r++){if(row+r<=-1||this.moduleCount<=row+r)continue;for(var c=-1;c<=7;c++){if(col+c<=-1||this.moduleCount<=col+c)continue;if((0<=r&&r<=6&&(c==0||c==6))||(0<=c&&c<=6&&(r==0||r==6))||(2<=r&&r<=4&&2<=c&&c<=4)){this.modules[row+r][col+c]=true;}else{this.modules[row+r][col+c]=false;}}}},getBestMaskPattern:function(){var minLostPoint=0;var pattern=0;for(var i=0;i<8;i++){this.makeImpl(true,i);var lostPoint=QRUtil.getLostPoint(this);if(i==0||minLostPoint>lostPoint){minLostPoint=lostPoint;pattern=i;}}\n\treturn pattern;},createMovieClip:function(target_mc,instance_name,depth){var qr_mc=target_mc.createEmptyMovieClip(instance_name,depth);var cs=1;this.make();for(var row=0;row<this.modules.length;row++){var y=row*cs;for(var col=0;col<this.modules[row].length;col++){var x=col*cs;var dark=this.modules[row][col];if(dark){qr_mc.beginFill(0,100);qr_mc.moveTo(x,y);qr_mc.lineTo(x+cs,y);qr_mc.lineTo(x+cs,y+cs);qr_mc.lineTo(x,y+cs);qr_mc.endFill();}}}\n\treturn qr_mc;},setupTimingPattern:function(){for(var r=8;r<this.moduleCount-8;r++){if(this.modules[r][6]!=null){continue;}\n\tthis.modules[r][6]=(r%2==0);}\n\tfor(var c=8;c<this.moduleCount-8;c++){if(this.modules[6][c]!=null){continue;}\n\tthis.modules[6][c]=(c%2==0);}},setupPositionAdjustPattern:function(){var pos=QRUtil.getPatternPosition(this.typeNumber);for(var i=0;i<pos.length;i++){for(var j=0;j<pos.length;j++){var row=pos[i];var col=pos[j];if(this.modules[row][col]!=null){continue;}\n\tfor(var r=-2;r<=2;r++){for(var c=-2;c<=2;c++){if(r==-2||r==2||c==-2||c==2||(r==0&&c==0)){this.modules[row+r][col+c]=true;}else{this.modules[row+r][col+c]=false;}}}}}},setupTypeNumber:function(test){var bits=QRUtil.getBCHTypeNumber(this.typeNumber);for(var i=0;i<18;i++){var mod=(!test&&((bits>>i)&1)==1);this.modules[Math.floor(i/3)][i%3+this.moduleCount-8-3]=mod;}\n\tfor(var i=0;i<18;i++){var mod=(!test&&((bits>>i)&1)==1);this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=mod;}},setupTypeInfo:function(test,maskPattern){var data=(this.errorCorrectLevel<<3)|maskPattern;var bits=QRUtil.getBCHTypeInfo(data);for(var i=0;i<15;i++){var mod=(!test&&((bits>>i)&1)==1);if(i<6){this.modules[i][8]=mod;}else if(i<8){this.modules[i+1][8]=mod;}else{this.modules[this.moduleCount-15+i][8]=mod;}}\n\tfor(var i=0;i<15;i++){var mod=(!test&&((bits>>i)&1)==1);if(i<8){this.modules[8][this.moduleCount-i-1]=mod;}else if(i<9){this.modules[8][15-i-1+1]=mod;}else{this.modules[8][15-i-1]=mod;}}\n\tthis.modules[this.moduleCount-8][8]=(!test);},mapData:function(data,maskPattern){var inc=-1;var row=this.moduleCount-1;var bitIndex=7;var byteIndex=0;for(var col=this.moduleCount-1;col>0;col-=2){if(col==6)col--;while(true){for(var c=0;c<2;c++){if(this.modules[row][col-c]==null){var dark=false;if(byteIndex<data.length){dark=(((data[byteIndex]>>>bitIndex)&1)==1);}\n\tvar mask=QRUtil.getMask(maskPattern,row,col-c);if(mask){dark=!dark;}\n\tthis.modules[row][col-c]=dark;bitIndex--;if(bitIndex==-1){byteIndex++;bitIndex=7;}}}\n\trow+=inc;if(row<0||this.moduleCount<=row){row-=inc;inc=-inc;break;}}}}};QRCodeModel.PAD0=0xEC;QRCodeModel.PAD1=0x11;QRCodeModel.createData=function(typeNumber,errorCorrectLevel,dataList){var rsBlocks=QRRSBlock.getRSBlocks(typeNumber,errorCorrectLevel);var buffer=new QRBitBuffer();for(var i=0;i<dataList.length;i++){var data=dataList[i];buffer.put(data.mode,4);buffer.put(data.getLength(),QRUtil.getLengthInBits(data.mode,typeNumber));data.write(buffer);}\n\tvar totalDataCount=0;for(var i=0;i<rsBlocks.length;i++){totalDataCount+=rsBlocks[i].dataCount;}\n\tif(buffer.getLengthInBits()>totalDataCount*8){throw new Error(\"code length overflow. (\"\n\t+buffer.getLengthInBits()\n\t+\">\"\n\t+totalDataCount*8\n\t+\")\");}\n\tif(buffer.getLengthInBits()+4<=totalDataCount*8){buffer.put(0,4);}\n\twhile(buffer.getLengthInBits()%8!=0){buffer.putBit(false);}\n\twhile(true){if(buffer.getLengthInBits()>=totalDataCount*8){break;}\n\tbuffer.put(QRCodeModel.PAD0,8);if(buffer.getLengthInBits()>=totalDataCount*8){break;}\n\tbuffer.put(QRCodeModel.PAD1,8);}\n\treturn QRCodeModel.createBytes(buffer,rsBlocks);};QRCodeModel.createBytes=function(buffer,rsBlocks){var offset=0;var maxDcCount=0;var maxEcCount=0;var dcdata=new Array(rsBlocks.length);var ecdata=new Array(rsBlocks.length);for(var r=0;r<rsBlocks.length;r++){var dcCount=rsBlocks[r].dataCount;var ecCount=rsBlocks[r].totalCount-dcCount;maxDcCount=Math.max(maxDcCount,dcCount);maxEcCount=Math.max(maxEcCount,ecCount);dcdata[r]=new Array(dcCount);for(var i=0;i<dcdata[r].length;i++){dcdata[r][i]=0xff&buffer.buffer[i+offset];}\n\toffset+=dcCount;var rsPoly=QRUtil.getErrorCorrectPolynomial(ecCount);var rawPoly=new QRPolynomial(dcdata[r],rsPoly.getLength()-1);var modPoly=rawPoly.mod(rsPoly);ecdata[r]=new Array(rsPoly.getLength()-1);for(var i=0;i<ecdata[r].length;i++){var modIndex=i+modPoly.getLength()-ecdata[r].length;ecdata[r][i]=(modIndex>=0)?modPoly.get(modIndex):0;}}\n\tvar totalCodeCount=0;for(var i=0;i<rsBlocks.length;i++){totalCodeCount+=rsBlocks[i].totalCount;}\n\tvar data=new Array(totalCodeCount);var index=0;for(var i=0;i<maxDcCount;i++){for(var r=0;r<rsBlocks.length;r++){if(i<dcdata[r].length){data[index++]=dcdata[r][i];}}}\n\tfor(var i=0;i<maxEcCount;i++){for(var r=0;r<rsBlocks.length;r++){if(i<ecdata[r].length){data[index++]=ecdata[r][i];}}}\n\treturn data;};var QRMode={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3};var QRErrorCorrectLevel={L:1,M:0,Q:3,H:2};var QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var QRUtil={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:(1<<10)|(1<<8)|(1<<5)|(1<<4)|(1<<2)|(1<<1)|(1<<0),G18:(1<<12)|(1<<11)|(1<<10)|(1<<9)|(1<<8)|(1<<5)|(1<<2)|(1<<0),G15_MASK:(1<<14)|(1<<12)|(1<<10)|(1<<4)|(1<<1),getBCHTypeInfo:function(data){var d=data<<10;while(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G15)>=0){d^=(QRUtil.G15<<(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G15)));}\n\treturn((data<<10)|d)^QRUtil.G15_MASK;},getBCHTypeNumber:function(data){var d=data<<12;while(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G18)>=0){d^=(QRUtil.G18<<(QRUtil.getBCHDigit(d)-QRUtil.getBCHDigit(QRUtil.G18)));}\n\treturn(data<<12)|d;},getBCHDigit:function(data){var digit=0;while(data!=0){digit++;data>>>=1;}\n\treturn digit;},getPatternPosition:function(typeNumber){return QRUtil.PATTERN_POSITION_TABLE[typeNumber-1];},getMask:function(maskPattern,i,j){switch(maskPattern){case QRMaskPattern.PATTERN000:return(i+j)%2==0;case QRMaskPattern.PATTERN001:return i%2==0;case QRMaskPattern.PATTERN010:return j%3==0;case QRMaskPattern.PATTERN011:return(i+j)%3==0;case QRMaskPattern.PATTERN100:return(Math.floor(i/2)+Math.floor(j/3))%2==0;case QRMaskPattern.PATTERN101:return(i*j)%2+(i*j)%3==0;case QRMaskPattern.PATTERN110:return((i*j)%2+(i*j)%3)%2==0;case QRMaskPattern.PATTERN111:return((i*j)%3+(i+j)%2)%2==0;default:throw new Error(\"bad maskPattern:\"+maskPattern);}},getErrorCorrectPolynomial:function(errorCorrectLength){var a=new QRPolynomial([1],0);for(var i=0;i<errorCorrectLength;i++){a=a.multiply(new QRPolynomial([1,QRMath.gexp(i)],0));}\n\treturn a;},getLengthInBits:function(mode,type){if(1<=type&&type<10){switch(mode){case QRMode.MODE_NUMBER:return 10;case QRMode.MODE_ALPHA_NUM:return 9;case QRMode.MODE_8BIT_BYTE:return 8;case QRMode.MODE_KANJI:return 8;default:throw new Error(\"mode:\"+mode);}}else if(type<27){switch(mode){case QRMode.MODE_NUMBER:return 12;case QRMode.MODE_ALPHA_NUM:return 11;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 10;default:throw new Error(\"mode:\"+mode);}}else if(type<41){switch(mode){case QRMode.MODE_NUMBER:return 14;case QRMode.MODE_ALPHA_NUM:return 13;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 12;default:throw new Error(\"mode:\"+mode);}}else{throw new Error(\"type:\"+type);}},getLostPoint:function(qrCode){var moduleCount=qrCode.getModuleCount();var lostPoint=0;for(var row=0;row<moduleCount;row++){for(var col=0;col<moduleCount;col++){var sameCount=0;var dark=qrCode.isDark(row,col);for(var r=-1;r<=1;r++){if(row+r<0||moduleCount<=row+r){continue;}\n\tfor(var c=-1;c<=1;c++){if(col+c<0||moduleCount<=col+c){continue;}\n\tif(r==0&&c==0){continue;}\n\tif(dark==qrCode.isDark(row+r,col+c)){sameCount++;}}}\n\tif(sameCount>5){lostPoint+=(3+sameCount-5);}}}\n\tfor(var row=0;row<moduleCount-1;row++){for(var col=0;col<moduleCount-1;col++){var count=0;if(qrCode.isDark(row,col))count++;if(qrCode.isDark(row+1,col))count++;if(qrCode.isDark(row,col+1))count++;if(qrCode.isDark(row+1,col+1))count++;if(count==0||count==4){lostPoint+=3;}}}\n\tfor(var row=0;row<moduleCount;row++){for(var col=0;col<moduleCount-6;col++){if(qrCode.isDark(row,col)&&!qrCode.isDark(row,col+1)&&qrCode.isDark(row,col+2)&&qrCode.isDark(row,col+3)&&qrCode.isDark(row,col+4)&&!qrCode.isDark(row,col+5)&&qrCode.isDark(row,col+6)){lostPoint+=40;}}}\n\tfor(var col=0;col<moduleCount;col++){for(var row=0;row<moduleCount-6;row++){if(qrCode.isDark(row,col)&&!qrCode.isDark(row+1,col)&&qrCode.isDark(row+2,col)&&qrCode.isDark(row+3,col)&&qrCode.isDark(row+4,col)&&!qrCode.isDark(row+5,col)&&qrCode.isDark(row+6,col)){lostPoint+=40;}}}\n\tvar darkCount=0;for(var col=0;col<moduleCount;col++){for(var row=0;row<moduleCount;row++){if(qrCode.isDark(row,col)){darkCount++;}}}\n\tvar ratio=Math.abs(100*darkCount/moduleCount/moduleCount-50)/5;lostPoint+=ratio*10;return lostPoint;}};var QRMath={glog:function(n){if(n<1){throw new Error(\"glog(\"+n+\")\");}\n\treturn QRMath.LOG_TABLE[n];},gexp:function(n){while(n<0){n+=255;}\n\twhile(n>=256){n-=255;}\n\treturn QRMath.EXP_TABLE[n];},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var i=0;i<8;i++){QRMath.EXP_TABLE[i]=1<<i;}\n\tfor(var i=8;i<256;i++){QRMath.EXP_TABLE[i]=QRMath.EXP_TABLE[i-4]^QRMath.EXP_TABLE[i-5]^QRMath.EXP_TABLE[i-6]^QRMath.EXP_TABLE[i-8];}\n\tfor(var i=0;i<255;i++){QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]]=i;}\n\tfunction QRPolynomial(num,shift){if(num.length==undefined){throw new Error(num.length+\"/\"+shift);}\n\tvar offset=0;while(offset<num.length&&num[offset]==0){offset++;}\n\tthis.num=new Array(num.length-offset+shift);for(var i=0;i<num.length-offset;i++){this.num[i]=num[i+offset];}}\n\tQRPolynomial.prototype={get:function(index){return this.num[index];},getLength:function(){return this.num.length;},multiply:function(e){var num=new Array(this.getLength()+e.getLength()-1);for(var i=0;i<this.getLength();i++){for(var j=0;j<e.getLength();j++){num[i+j]^=QRMath.gexp(QRMath.glog(this.get(i))+QRMath.glog(e.get(j)));}}\n\treturn new QRPolynomial(num,0);},mod:function(e){if(this.getLength()-e.getLength()<0){return this;}\n\tvar ratio=QRMath.glog(this.get(0))-QRMath.glog(e.get(0));var num=new Array(this.getLength());for(var i=0;i<this.getLength();i++){num[i]=this.get(i);}\n\tfor(var i=0;i<e.getLength();i++){num[i]^=QRMath.gexp(QRMath.glog(e.get(i))+ratio);}\n\treturn new QRPolynomial(num,0).mod(e);}};function QRRSBlock(totalCount,dataCount){this.totalCount=totalCount;this.dataCount=dataCount;}\n\tQRRSBlock.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];QRRSBlock.getRSBlocks=function(typeNumber,errorCorrectLevel){var rsBlock=QRRSBlock.getRsBlockTable(typeNumber,errorCorrectLevel);if(rsBlock==undefined){throw new Error(\"bad rs block @ typeNumber:\"+typeNumber+\"/errorCorrectLevel:\"+errorCorrectLevel);}\n\tvar length=rsBlock.length/3;var list=[];for(var i=0;i<length;i++){var count=rsBlock[i*3+0];var totalCount=rsBlock[i*3+1];var dataCount=rsBlock[i*3+2];for(var j=0;j<count;j++){list.push(new QRRSBlock(totalCount,dataCount));}}\n\treturn list;};QRRSBlock.getRsBlockTable=function(typeNumber,errorCorrectLevel){switch(errorCorrectLevel){case QRErrorCorrectLevel.L:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+0];case QRErrorCorrectLevel.M:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+1];case QRErrorCorrectLevel.Q:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+2];case QRErrorCorrectLevel.H:return QRRSBlock.RS_BLOCK_TABLE[(typeNumber-1)*4+3];default:return undefined;}};function QRBitBuffer(){this.buffer=[];this.length=0;}\n\tQRBitBuffer.prototype={get:function(index){var bufIndex=Math.floor(index/8);return((this.buffer[bufIndex]>>>(7-index%8))&1)==1;},put:function(num,length){for(var i=0;i<length;i++){this.putBit(((num>>>(length-i-1))&1)==1);}},getLengthInBits:function(){return this.length;},putBit:function(bit){var bufIndex=Math.floor(this.length/8);if(this.buffer.length<=bufIndex){this.buffer.push(0);}\n\tif(bit){this.buffer[bufIndex]|=(0x80>>>(this.length%8));}\n\tthis.length++;}};var QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];\n\t\n\tfunction _isSupportCanvas() {\n\t\treturn typeof CanvasRenderingContext2D != \"undefined\";\n\t}\n\t\n\t// android 2.x doesn't support Data-URI spec\n\tfunction _getAndroid() {\n\t\tvar android = false;\n\t\tvar sAgent = navigator.userAgent;\n\t\t\n\t\tif (/android/i.test(sAgent)) { // android\n\t\t\tandroid = true;\n\t\t\tvar aMat = sAgent.toString().match(/android ([0-9]\\.[0-9])/i);\n\t\t\t\n\t\t\tif (aMat && aMat[1]) {\n\t\t\t\tandroid = parseFloat(aMat[1]);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn android;\n\t}\n\t\n\tvar svgDrawer = (function() {\n\n\t\tvar Drawing = function (el, htOption) {\n\t\t\tthis._el = el;\n\t\t\tthis._htOption = htOption;\n\t\t};\n\n\t\tDrawing.prototype.draw = function (oQRCode) {\n\t\t\tvar _htOption = this._htOption;\n\t\t\tvar _el = this._el;\n\t\t\tvar nCount = oQRCode.getModuleCount();\n\t\t\tvar nWidth = Math.floor(_htOption.width / nCount);\n\t\t\tvar nHeight = Math.floor(_htOption.height / nCount);\n\n\t\t\tthis.clear();\n\n\t\t\tfunction makeSVG(tag, attrs) {\n\t\t\t\tvar el = document.createElementNS('http://www.w3.org/2000/svg', tag);\n\t\t\t\tfor (var k in attrs)\n\t\t\t\t\tif (attrs.hasOwnProperty(k)) el.setAttribute(k, attrs[k]);\n\t\t\t\treturn el;\n\t\t\t}\n\n\t\t\tvar svg = makeSVG(\"svg\" , {'viewBox': '0 0 ' + String(nCount) + \" \" + String(nCount), 'width': '100%', 'height': '100%', 'fill': _htOption.colorLight});\n\t\t\tsvg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n\t\t\t_el.appendChild(svg);\n\n\t\t\tsvg.appendChild(makeSVG(\"rect\", {\"fill\": _htOption.colorLight, \"width\": \"100%\", \"height\": \"100%\"}));\n\t\t\tsvg.appendChild(makeSVG(\"rect\", {\"fill\": _htOption.colorDark, \"width\": \"1\", \"height\": \"1\", \"id\": \"template\"}));\n\n\t\t\tfor (var row = 0; row < nCount; row++) {\n\t\t\t\tfor (var col = 0; col < nCount; col++) {\n\t\t\t\t\tif (oQRCode.isDark(row, col)) {\n\t\t\t\t\t\tvar child = makeSVG(\"use\", {\"x\": String(row), \"y\": String(col)});\n\t\t\t\t\t\tchild.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\", \"#template\")\n\t\t\t\t\t\tsvg.appendChild(child);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tDrawing.prototype.clear = function () {\n\t\t\twhile (this._el.hasChildNodes())\n\t\t\t\tthis._el.removeChild(this._el.lastChild);\n\t\t};\n\t\treturn Drawing;\n\t})();\n\n\tvar useSVG = document.documentElement.tagName.toLowerCase() === \"svg\";\n\n\t// Drawing in DOM by using Table tag\n\tvar Drawing = useSVG ? svgDrawer : !_isSupportCanvas() ? (function () {\n\t\tvar Drawing = function (el, htOption) {\n\t\t\tthis._el = el;\n\t\t\tthis._htOption = htOption;\n\t\t};\n\t\t\t\n\t\t/**\n\t\t * Draw the QRCode\n\t\t * \n\t\t * @param {QRCode} oQRCode\n\t\t */\n\t\tDrawing.prototype.draw = function (oQRCode) {\n            var _htOption = this._htOption;\n            var _el = this._el;\n\t\t\tvar nCount = oQRCode.getModuleCount();\n\t\t\tvar nWidth = Math.floor(_htOption.width / nCount);\n\t\t\tvar nHeight = Math.floor(_htOption.height / nCount);\n\t\t\tvar aHTML = ['<table style=\"border:0;border-collapse:collapse;\">'];\n\t\t\t\n\t\t\tfor (var row = 0; row < nCount; row++) {\n\t\t\t\taHTML.push('<tr>');\n\t\t\t\t\n\t\t\t\tfor (var col = 0; col < nCount; col++) {\n\t\t\t\t\taHTML.push('<td style=\"border:0;border-collapse:collapse;padding:0;margin:0;width:' + nWidth + 'px;height:' + nHeight + 'px;background-color:' + (oQRCode.isDark(row, col) ? _htOption.colorDark : _htOption.colorLight) + ';\"></td>');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\taHTML.push('</tr>');\n\t\t\t}\n\t\t\t\n\t\t\taHTML.push('</table>');\n\t\t\t_el.innerHTML = aHTML.join('');\n\t\t\t\n\t\t\t// Fix the margin values as real size.\n\t\t\tvar elTable = _el.childNodes[0];\n\t\t\tvar nLeftMarginTable = (_htOption.width - elTable.offsetWidth) / 2;\n\t\t\tvar nTopMarginTable = (_htOption.height - elTable.offsetHeight) / 2;\n\t\t\t\n\t\t\tif (nLeftMarginTable > 0 && nTopMarginTable > 0) {\n\t\t\t\telTable.style.margin = nTopMarginTable + \"px \" + nLeftMarginTable + \"px\";\t\n\t\t\t}\n\t\t};\n\t\t\n\t\t/**\n\t\t * Clear the QRCode\n\t\t */\n\t\tDrawing.prototype.clear = function () {\n\t\t\tthis._el.innerHTML = '';\n\t\t};\n\t\t\n\t\treturn Drawing;\n\t})() : (function () { // Drawing in Canvas\n\t\tfunction _onMakeImage() {\n\t\t\tthis._elImage.src = this._elCanvas.toDataURL(\"image/png\");\n\t\t\tthis._elImage.style.display = \"block\";\n\t\t\tthis._elCanvas.style.display = \"none\";\t\t\t\n\t\t}\n\t\t\n\t\t// Android 2.1 bug workaround\n\t\t// http://code.google.com/p/android/issues/detail?id=5141\n\t\tif (this._android && this._android <= 2.1) {\n\t    \tvar factor = 1 / window.devicePixelRatio;\n\t        var drawImage = CanvasRenderingContext2D.prototype.drawImage; \n\t    \tCanvasRenderingContext2D.prototype.drawImage = function (image, sx, sy, sw, sh, dx, dy, dw, dh) {\n\t    \t\tif ((\"nodeName\" in image) && /img/i.test(image.nodeName)) {\n\t\t        \tfor (var i = arguments.length - 1; i >= 1; i--) {\n\t\t            \targuments[i] = arguments[i] * factor;\n\t\t        \t}\n\t    \t\t} else if (typeof dw == \"undefined\") {\n\t    \t\t\targuments[1] *= factor;\n\t    \t\t\targuments[2] *= factor;\n\t    \t\t\targuments[3] *= factor;\n\t    \t\t\targuments[4] *= factor;\n\t    \t\t}\n\t    \t\t\n\t        \tdrawImage.apply(this, arguments); \n\t    \t};\n\t\t}\n\t\t\n\t\t/**\n\t\t * Check whether the user's browser supports Data URI or not\n\t\t * \n\t\t * @private\n\t\t * @param {Function} fSuccess Occurs if it supports Data URI\n\t\t * @param {Function} fFail Occurs if it doesn't support Data URI\n\t\t */\n\t\tfunction _safeSetDataURI(fSuccess, fFail) {\n            var self = this;\n            self._fFail = fFail;\n            self._fSuccess = fSuccess;\n\n            // Check it just once\n            if (self._bSupportDataURI === null) {\n                var el = document.createElement(\"img\");\n                var fOnError = function() {\n                    self._bSupportDataURI = false;\n\n                    if (self._fFail) {\n                        self._fFail.call(self);\n                    }\n                };\n                var fOnSuccess = function() {\n                    self._bSupportDataURI = true;\n\n                    if (self._fSuccess) {\n                        self._fSuccess.call(self);\n                    }\n                };\n\n                el.onabort = fOnError;\n                el.onerror = fOnError;\n                el.onload = fOnSuccess;\n                el.src = \"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\"; // the Image contains 1px data.\n                return;\n            } else if (self._bSupportDataURI === true && self._fSuccess) {\n                self._fSuccess.call(self);\n            } else if (self._bSupportDataURI === false && self._fFail) {\n                self._fFail.call(self);\n            }\n\t\t};\n\t\t\n\t\t/**\n\t\t * Drawing QRCode by using canvas\n\t\t * \n\t\t * @constructor\n\t\t * @param {HTMLElement} el\n\t\t * @param {Object} htOption QRCode Options \n\t\t */\n\t\tvar Drawing = function (el, htOption) {\n    \t\tthis._bIsPainted = false;\n    \t\tthis._android = _getAndroid();\n\t\t\n\t\t\tthis._htOption = htOption;\n\t\t\tthis._elCanvas = document.createElement(\"canvas\");\n\t\t\tthis._elCanvas.width = htOption.width;\n\t\t\tthis._elCanvas.height = htOption.height;\n\t\t\tel.appendChild(this._elCanvas);\n\t\t\tthis._el = el;\n\t\t\tthis._oContext = this._elCanvas.getContext(\"2d\");\n\t\t\tthis._bIsPainted = false;\n\t\t\tthis._elImage = document.createElement(\"img\");\n\t\t\tthis._elImage.alt = \"Scan me!\";\n\t\t\tthis._elImage.style.display = \"none\";\n\t\t\tthis._el.appendChild(this._elImage);\n\t\t\tthis._bSupportDataURI = null;\n\t\t};\n\t\t\t\n\t\t/**\n\t\t * Draw the QRCode\n\t\t * \n\t\t * @param {QRCode} oQRCode \n\t\t */\n\t\tDrawing.prototype.draw = function (oQRCode) {\n            var _elImage = this._elImage;\n            var _oContext = this._oContext;\n            var _htOption = this._htOption;\n            \n\t\t\tvar nCount = oQRCode.getModuleCount();\n\t\t\tvar nWidth = _htOption.width / nCount;\n\t\t\tvar nHeight = _htOption.height / nCount;\n\t\t\tvar nRoundedWidth = Math.round(nWidth);\n\t\t\tvar nRoundedHeight = Math.round(nHeight);\n\n\t\t\t_elImage.style.display = \"none\";\n\t\t\tthis.clear();\n\t\t\t\n\t\t\tfor (var row = 0; row < nCount; row++) {\n\t\t\t\tfor (var col = 0; col < nCount; col++) {\n\t\t\t\t\tvar bIsDark = oQRCode.isDark(row, col);\n\t\t\t\t\tvar nLeft = col * nWidth;\n\t\t\t\t\tvar nTop = row * nHeight;\n\t\t\t\t\t_oContext.strokeStyle = bIsDark ? _htOption.colorDark : _htOption.colorLight;\n\t\t\t\t\t_oContext.lineWidth = 1;\n\t\t\t\t\t_oContext.fillStyle = bIsDark ? _htOption.colorDark : _htOption.colorLight;\t\t\t\t\t\n\t\t\t\t\t_oContext.fillRect(nLeft, nTop, nWidth, nHeight);\n\t\t\t\t\t\n\t\t\t\t\t// 안티 앨리어싱 방지 처리\n\t\t\t\t\t_oContext.strokeRect(\n\t\t\t\t\t\tMath.floor(nLeft) + 0.5,\n\t\t\t\t\t\tMath.floor(nTop) + 0.5,\n\t\t\t\t\t\tnRoundedWidth,\n\t\t\t\t\t\tnRoundedHeight\n\t\t\t\t\t);\n\t\t\t\t\t\n\t\t\t\t\t_oContext.strokeRect(\n\t\t\t\t\t\tMath.ceil(nLeft) - 0.5,\n\t\t\t\t\t\tMath.ceil(nTop) - 0.5,\n\t\t\t\t\t\tnRoundedWidth,\n\t\t\t\t\t\tnRoundedHeight\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis._bIsPainted = true;\n\t\t};\n\t\t\t\n\t\t/**\n\t\t * Make the image from Canvas if the browser supports Data URI.\n\t\t */\n\t\tDrawing.prototype.makeImage = function () {\n\t\t\tif (this._bIsPainted) {\n\t\t\t\t_safeSetDataURI.call(this, _onMakeImage);\n\t\t\t}\n\t\t};\n\t\t\t\n\t\t/**\n\t\t * Return whether the QRCode is painted or not\n\t\t * \n\t\t * @return {Boolean}\n\t\t */\n\t\tDrawing.prototype.isPainted = function () {\n\t\t\treturn this._bIsPainted;\n\t\t};\n\t\t\n\t\t/**\n\t\t * Clear the QRCode\n\t\t */\n\t\tDrawing.prototype.clear = function () {\n\t\t\tthis._oContext.clearRect(0, 0, this._elCanvas.width, this._elCanvas.height);\n\t\t\tthis._bIsPainted = false;\n\t\t};\n\t\t\n\t\t/**\n\t\t * @private\n\t\t * @param {Number} nNumber\n\t\t */\n\t\tDrawing.prototype.round = function (nNumber) {\n\t\t\tif (!nNumber) {\n\t\t\t\treturn nNumber;\n\t\t\t}\n\t\t\t\n\t\t\treturn Math.floor(nNumber * 1000) / 1000;\n\t\t};\n\t\t\n\t\treturn Drawing;\n\t})();\n\t\n\t/**\n\t * Get the type by string length\n\t * \n\t * @private\n\t * @param {String} sText\n\t * @param {Number} nCorrectLevel\n\t * @return {Number} type\n\t */\n\tfunction _getTypeNumber(sText, nCorrectLevel) {\t\t\t\n\t\tvar nType = 1;\n\t\tvar length = _getUTF8Length(sText);\n\t\t\n\t\tfor (var i = 0, len = QRCodeLimitLength.length; i <= len; i++) {\n\t\t\tvar nLimit = 0;\n\t\t\t\n\t\t\tswitch (nCorrectLevel) {\n\t\t\t\tcase QRErrorCorrectLevel.L :\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][0];\n\t\t\t\t\tbreak;\n\t\t\t\tcase QRErrorCorrectLevel.M :\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase QRErrorCorrectLevel.Q :\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][2];\n\t\t\t\t\tbreak;\n\t\t\t\tcase QRErrorCorrectLevel.H :\n\t\t\t\t\tnLimit = QRCodeLimitLength[i][3];\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tif (length <= nLimit) {\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tnType++;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (nType > QRCodeLimitLength.length) {\n\t\t\tthrow new Error(\"Too long data\");\n\t\t}\n\t\t\n\t\treturn nType;\n\t}\n\n\tfunction _getUTF8Length(sText) {\n\t\tvar replacedText = encodeURI(sText).toString().replace(/\\%[0-9a-fA-F]{2}/g, 'a');\n\t\treturn replacedText.length + (replacedText.length != sText ? 3 : 0);\n\t}\n\t\n\t/**\n\t * @class QRCode\n\t * @constructor\n\t * @example \n\t * new QRCode(document.getElementById(\"test\"), \"http://jindo.dev.naver.com/collie\");\n\t *\n\t * @example\n\t * var oQRCode = new QRCode(\"test\", {\n\t *    text : \"http://naver.com\",\n\t *    width : 128,\n\t *    height : 128\n\t * });\n\t * \n\t * oQRCode.clear(); // Clear the QRCode.\n\t * oQRCode.makeCode(\"http://map.naver.com\"); // Re-create the QRCode.\n\t *\n\t * @param {HTMLElement|String} el target element or 'id' attribute of element.\n\t * @param {Object|String} vOption\n\t * @param {String} vOption.text QRCode link data\n\t * @param {Number} [vOption.width=256]\n\t * @param {Number} [vOption.height=256]\n\t * @param {String} [vOption.colorDark=\"#000000\"]\n\t * @param {String} [vOption.colorLight=\"#ffffff\"]\n\t * @param {QRCode.CorrectLevel} [vOption.correctLevel=QRCode.CorrectLevel.H] [L|M|Q|H] \n\t */\n\tQRCode = function (el, vOption) {\n\t\tthis._htOption = {\n\t\t\twidth : 256, \n\t\t\theight : 256,\n\t\t\ttypeNumber : 4,\n\t\t\tcolorDark : \"#000000\",\n\t\t\tcolorLight : \"#ffffff\",\n\t\t\tcorrectLevel : QRErrorCorrectLevel.H\n\t\t};\n\t\t\n\t\tif (typeof vOption === 'string') {\n\t\t\tvOption\t= {\n\t\t\t\ttext : vOption\n\t\t\t};\n\t\t}\n\t\t\n\t\t// Overwrites options\n\t\tif (vOption) {\n\t\t\tfor (var i in vOption) {\n\t\t\t\tthis._htOption[i] = vOption[i];\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (typeof el == \"string\") {\n\t\t\tel = document.getElementById(el);\n\t\t}\n\n\t\tif (this._htOption.useSVG) {\n\t\t\tDrawing = svgDrawer;\n\t\t}\n\t\t\n\t\tthis._android = _getAndroid();\n\t\tthis._el = el;\n\t\tthis._oQRCode = null;\n\t\tthis._oDrawing = new Drawing(this._el, this._htOption);\n\t\t\n\t\tif (this._htOption.text) {\n\t\t\tthis.makeCode(this._htOption.text);\t\n\t\t}\n\t};\n\t\n\t/**\n\t * Make the QRCode\n\t * \n\t * @param {String} sText link data\n\t */\n\tQRCode.prototype.makeCode = function (sText) {\n\t\tthis._oQRCode = new QRCodeModel(_getTypeNumber(sText, this._htOption.correctLevel), this._htOption.correctLevel);\n\t\tthis._oQRCode.addData(sText);\n\t\tthis._oQRCode.make();\n\t\tthis._el.title = sText;\n\t\tthis._oDrawing.draw(this._oQRCode);\t\t\t\n\t\tthis.makeImage();\n\t};\n\t\n\t/**\n\t * Make the Image from Canvas element\n\t * - It occurs automatically\n\t * - Android below 3 doesn't support Data-URI spec.\n\t * \n\t * @private\n\t */\n\tQRCode.prototype.makeImage = function () {\n\t\tif (typeof this._oDrawing.makeImage == \"function\" && (!this._android || this._android >= 3)) {\n\t\t\tthis._oDrawing.makeImage();\n\t\t}\n\t};\n\t\n\t/**\n\t * Clear the QRCode\n\t */\n\tQRCode.prototype.clear = function () {\n\t\tthis._oDrawing.clear();\n\t};\n\t\n\t/**\n\t * @name QRCode.CorrectLevel\n\t */\n\tQRCode.CorrectLevel = QRErrorCorrectLevel;\n\t\n\treturn QRCode;\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiPrint/runner/testRunner',[\n    'jquery',\n    'lodash',\n    'async',\n    'helpers',\n    'taoQtiPrint/runner/itemRunner',\n    'taoQtiPrint/lib/qrcode'\n], function($, _, async, helpers, itemRunner, QRCode) {\n    'use str11ict';\n\n    //TODO find him his own place. Waiting is own house, the testRenderer squats the runner flat.\n    var testRenderer = {\n\n        createPage: function createPage(type) {\n            return $('<section></section>').addClass(type);\n        },\n\n        //TODO replace by a template\n        testPage: function rendertestPage(test, done) {\n\n            var $testPage = this.createPage('title');\n            var $codeElt = $('<div class=\"qr-code\">');\n            var qrCode = new QRCode($codeElt[0], {\n                text:         helpers._url('render', 'PrintTest', 'taoBooklet', { uri :  test.uri}),\n                width:        192,\n                height:       192,\n                colorDark:    \"#000000\",\n                colorLight:   \"#ffffff\",\n                correctLevel: QRCode.CorrectLevel.H\n            });\n\n            $testPage.append('<h1>' + test.title + '</h1>')\n                     .append($codeElt);\n\n            done(null, $testPage);\n        },\n\n        //TODO replace by a template\n        sectionPage: function renderSectionPage(section, pageNum, done) {\n\n\n            var $sectionPage = this.createPage('section');\n\n            $sectionPage.append('<h2>' + section.title + '</h2>');\n\n            _.forEach(section.rubricBlock, function(rubricBlock) {\n                $sectionPage.append('<div>' + rubricBlock + '</div>');\n            });\n            done(null, $sectionPage);\n        },\n\n        itemPage: function renderItemPage(item, uri, pageNum, done) {\n            var $itemContainer = this.createPage('item');\n\n            itemRunner('qtiprint', item, { uri : uri})\n                .on('error', function(err) {\n                    done(err);\n                })\n                .on('render', function() {\n                    done(null, $itemContainer);\n                })\n                .init()\n                .render($itemContainer);\n        }\n    };\n\n    /**\n     *\n     * Builds a brand new {@link TestRunner}.\n     *\n     * <strong>The factory is an internal mechanism to create encapsulated contexts.\n     *  I suggest you to use directly the name <i>testRunner</i> when you require this module.</strong>\n     *\n     *\n     * @exports testRunner\n     * @namespace testRunnerFactory\n     *\n     *\n     * @returns {TestRunner}\n     */\n    var testRunnerFactory = function testRunnerFactory(testData, options) {\n\n        testData = testData || {};\n\n        if (!testData || !testData.data || !testData.items) {\n            throw new Error('Invalid test data structure');\n        }\n\n        //contains the bound events.\n        var events = {};\n\n        var testRunner = {\n\n            /**\n             * Test container\n             * @type {jQueryElement}\n             */\n            $container: null,\n\n            /**\n             * Initialize the current item.\n             *\n             * @param {HTMLElement|jQueryElement} elt - the DOM element that is going to contain the rendered test.\n             * @returns {TestRunner} to chain calls\n             *\n             * @fires TestRunner#ready\n             * @fires TestRunner#render\n             * @fires TestRunner#error if the elt isn't valid\n             *\n             * @fires TestRunner#statechange the provider is reponsible to trigger this event\n             * @fires TestRunner#responsechange  the provider is reponsible to trigger this event\n             */\n            render: function(elt) {\n                var self = this;\n                var pageRenderers = [];\n\n                //check elt\n                if (!(elt instanceof HTMLElement) && !(elt instanceof $)) {\n                    return self.trigger('error', 'A valid HTMLElement (or a jquery element) at least is required to render the test');\n                }\n\n                //we keep a reference to the container\n                if (elt instanceof $) {\n                    this.$container = elt;\n                } else {\n                    this.$container = $(elt);\n                }\n\n                //Build the pageRenderers array that contains each page to render\n\n                //transform the function of the renderer to fit the format required by async (partial with data and binding)\n                pageRenderers.push(\n                    _.bind(\n                        _.partial(testRenderer.testPage, testData.data),\n                        testRenderer\n                    )\n                );\n\n                _.forEach(testData.data.testParts, function(testPart) {\n                    _.forEach(testPart.sections, function(section) {\n\n                        pageRenderers.push(\n                            _.bind(\n                                _.partial(testRenderer.sectionPage, section, pageRenderers.length),\n                                testRenderer\n                            )\n                        );\n\n                        _.forEach(section.items, function(item) {\n                            //\n                            if (testData.items[item.href] && testData.items[item.href].data) {\n                                //transform the function of the renderer to fit the format required by async (partial with data and binding)\n                                pageRenderers.push(\n                                    _.bind(\n                                        _.partial(testRenderer.itemPage, testData.items[item.href].data, item.href, pageRenderers.length),\n                                        testRenderer\n                                   )\n                                );\n                            }\n                        });\n                    });\n                });\n\n                //then we call all the renderers in parallel\n                async.parallel(pageRenderers, function renderingDone(err, $results) {\n                    if (err) {\n                        self.trigger('error', 'An error occurred while rendering a page :  ' + err);\n                    }\n\n                    //dummy rtl support from options\n                    if(options && options.rtl === true){\n                        self.$container.addClass('rtl').attr('dir', 'rtl');\n                    }\n\n                    //once they are all done, we insert the content to the container\n                    self.$container.empty().append($results);\n\n\n                    /**\n                     * The test is rendered\n                     * @event TestRunner#render\n                     */\n                    self.trigger('render');\n\n                    /**\n                     * The test is ready.\n                     * Alias of {@link TestRunner#render}\n                     * @event TestRunner#ready\n                     */\n                    self.trigger('ready');\n                });\n\n                return this;\n            },\n\n            /**\n             * Clear the running test.\n             * @returns {TestRunner}\n             *\n             * @fires TestRunner#clear\n             */\n            clear: function() {\n\n                this.$container.empty();\n\n                /**\n                 * The test is ready.\n                 * @event TestRunner#clear\n                 */\n                this.trigger('clear');\n\n                return this;\n            },\n            /**\n             * Attach an event handler.\n             * Calling `on` with the same eventName multiple times add callbacks: they\n             * will all be executed.\n             *\n             * @param {String} name - the name of the event to listen\n             * @param {Function} handler - the callback to run once the event is triggered. It's executed with the current testRunner context (ie. this\n             * @returns {TestRunner}\n             */\n            on: function(name, handler) {\n                if (_.isString(name) && _.isFunction(handler)) {\n                    events[name] = events[name] || [];\n                    events[name].push(handler);\n                }\n                return this;\n            },\n\n            /**\n             * Remove handlers for an event.\n             *\n             * @param {String} name - the event name\n             * @returns {TestRunner}\n             */\n            off: function(name) {\n                if (_.isString(name)) {\n                    events[name] = [];\n                }\n                return this;\n            },\n\n            /**\n             * Trigger an event manually.\n             *\n             * @param {String} name - the name of the event to trigger\n             * @param {*} data - arguments given to the handlers\n             * @returns {TestRunner}\n             */\n            trigger: function(name, data) {\n                var self = this;\n                if (_.isString(name) && _.isArray(events[name])) {\n                    _.forEach(events[name], function(event) {\n                        event.call(self, data);\n                    });\n                }\n                return this;\n            }\n        };\n\n        return testRunner;\n    };\n\n    return testRunnerFactory;\n});\n\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n */\n\n/**\n *\n * This controller renders a printable test in the current page.\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoBooklet/controller/printtest/render',[\n    'jquery',\n    'taoQtiPrint/runner/testRunner'\n], function($, testRunner){\n    'use strict';\n\n    /**\n     * As the page can be called by an external tool and\n     * as we build the page in JS asynchronously, we need this hack\n     * to tell the 3rd part tool that the page is ready.\n     */\n    var ready = function ready(){\n        window.status = 'runner-ready';\n    };\n\n    /**\n     * Old school way to debug document, especially when generated in PDF.\n     * It appends the message to the body.\n     * @param {String} msg - the content to display\n     */\n    var showMessage = function showMessage(msg, type){\n        type = type || 'info';\n        $('body').append('<div class=\"feedback-' + type + '\">'  + msg + '</div>');\n    };\n\n    /**\n     * Hack the current layout to match arbitrary rules\n     */\n    var printLayoutHacking = function printLayoutHacking($container){\n\n        var threshold = 6000;   //this height seems to work - value is empirical and linked to the A4 page layout with 300 DPI\n        var pages = 2;          //start on page 2\n        var previous;           //keep a ref to the previous section\n\n        //add a blank page\n        var blankPage = function blankPage( $section ){\n            $section.before('<div class=\"breaker\"></div>');\n            pages++;\n        };\n\n        //add pages based on the given height\n        var computePageFromHeight = function computePageFromHeight(height){\n            if(height > threshold){\n                pages += Math.ceil(height / threshold) - 1;\n            }\n        };\n\n        //browse direct section add apply the odd/even rules for section and items\n        $container.children('section').each(function(){\n            var $section = $(this);\n            var height;\n            var msg = '';\n\n            if($section.hasClass('section')){\n\n                if(pages % 2 === 0){\n                    blankPage($section);\n                }\n\n                computePageFromHeight($section.outerHeight());\n\n                previous = 'section';\n                pages++;\n            }\n            if($section.hasClass('item')){\n                if(previous !== 'item'){\n\n                    if(pages % 2 !== 0){\n                        blankPage($section);\n                    }\n\n                    height = $section.outerHeight();\n                    $section.nextUntil('.section', '.item').each(function(){\n                        height += $(this).outerHeight();\n                    });\n                    computePageFromHeight(height);\n\n                    pages++;\n                }\n                previous = 'item';\n            }\n        });\n    };\n\n    /**\n     * The renderer controller\n     */\n    var renderController = {\n\n        /**\n         * Controller entry point\n         * @param {Object} testData - the packed test data required by the testRunner\n         */\n        start : function start(testData, options){\n\n            //this is just in case something went wrong, but we weren't able to catch it.\n            setTimeout(function(){\n                showMessage(\"Something went wrong...\", 'error');\n                ready();\n            }, 45*1000);\n\n\n            //the content will be inserted in a detached element (to save time)\n            var $mainContainer = $('<main>');\n\n            //instantiate the TestRunner\n            testRunner(testData, options)\n              .on('error', function(e){\n                console.error(e);\n                showMessage(e, 'error');\n                ready();\n              })\n              .on('ready', function(){\n\n                //we attach the container to the DOM\n                $('body').append($mainContainer);\n\n                //hacky layout calculation\n                printLayoutHacking($mainContainer);\n\n                //we are done\n                ready();\n              })\n              .render($mainContainer);\n        }\n    };\n\n    /**\n     * @exports taoBooklet/controller/printtest/render\n     */\n    return renderController;\n});\n\n"]}